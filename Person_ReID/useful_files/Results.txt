
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>###########################################################
'###########################################################' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>###########################################################
'###########################################################' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>### Market
'###' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>###########################################################
'###########################################################' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>## ResNet18
'##' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID># Baseline
'#' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0  --name use_rn18_market_1 --use_rn18 --batchsize 32  --data_dir data/Market/pytorch --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), RandomHorizontalFlip(p=0.5)]
13.46265721321106
Trainable parameters: 11825455
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
 92%|███████████████████▍ | 11264/12185 [00:29<00:01, 466.12it/s, phase=train, Loss=4.1075, A 93%|███████████████████▍ | 11296/12185 [00:29<00:01, 446.64it/s, phase=train, Loss=4.1075, A 93%|███████████████████▍ | 11296/12185 [00:29<0100%|█████████████████████| 12185/12185 [00:32<00:00, 380.50it/s, phase=train, Loss=4.9400, Acc=0.1390]
100%|█████████████████████████████████████████| 751/751 [00:14<00:00, 50.76it/s, phase=val, Loss=4.0246, Acc=0.1758]
Training complete in 0m 47s
Best val Acc: 0.175766
Epoch 1/29
100%|██████████████████████████████████| 12185/12185 [00:16<00:00, 725.34it/s, phase=train, Loss=2.2930, Acc=0.4652]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1714.83it/s, phase=val, Loss=2.8914, Acc=0.3382]
Training complete in 1m 4s
Best val Acc: 0.338216
Epoch 2/29
100%|██████████████████████████████████| 12185/12185 [00:16<00:00, 717.41it/s, phase=train, Loss=1.3503, Acc=0.6605]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1576.45it/s, phase=val, Loss=2.3171, Acc=0.4234]
Training complete in 1m 22s
Best val Acc: 0.423435
Epoch 3/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 702.38it/s, phase=train, Loss=0.9187, Acc=0.7519]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1653.82it/s, phase=val, Loss=1.8357, Acc=0.5459]
Training complete in 1m 40s
Best val Acc: 0.545939
Epoch 4/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 704.25it/s, phase=train, Loss=0.6616, Acc=0.8190]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1574.07it/s, phase=val, Loss=1.7826, Acc=0.5606]
Training complete in 1m 58s
Best val Acc: 0.560586
Epoch 5/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 700.62it/s, phase=train, Loss=0.5193, Acc=0.8584]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1539.21it/s, phase=val, Loss=1.5139, Acc=0.6178]
Training complete in 2m 16s
Best val Acc: 0.617843
Epoch 6/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 696.36it/s, phase=train, Loss=0.4148, Acc=0.8815]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1435.63it/s, phase=val, Loss=1.5093, Acc=0.6218]
Training complete in 2m 35s
Best val Acc: 0.621838
Epoch 7/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 704.21it/s, phase=train, Loss=0.3615, Acc=0.8967]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1566.39it/s, phase=val, Loss=1.4880, Acc=0.6272]
Training complete in 2m 52s
Best val Acc: 0.627164
Epoch 8/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 704.12it/s, phase=train, Loss=0.3098, Acc=0.9155]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1486.80it/s, phase=val, Loss=1.3924, Acc=0.6325]
Training complete in 3m 10s
Best val Acc: 0.632490
Epoch 9/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 704.53it/s, phase=train, Loss=0.2802, Acc=0.9245]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1497.55it/s, phase=val, Loss=1.3846, Acc=0.6525]
Training complete in 3m 29s
Best val Acc: 0.652463
Epoch 10/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 693.18it/s, phase=train, Loss=0.2485, Acc=0.9341]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1626.06it/s, phase=val, Loss=1.3365, Acc=0.6525]
Training complete in 3m 47s
Best val Acc: 0.652463
Epoch 11/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 696.95it/s, phase=train, Loss=0.2294, Acc=0.9400]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1591.05it/s, phase=val, Loss=1.2862, Acc=0.6658]
Training complete in 4m 5s
Best val Acc: 0.665779
Epoch 12/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 696.93it/s, phase=train, Loss=0.2108, Acc=0.9467]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1584.04it/s, phase=val, Loss=1.1936, Acc=0.6778]
Training complete in 4m 23s
Best val Acc: 0.677763
Epoch 13/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 704.25it/s, phase=train, Loss=0.1746, Acc=0.9560]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1569.03it/s, phase=val, Loss=1.2733, Acc=0.6698]
Training complete in 4m 41s
Best val Acc: 0.677763
Epoch 14/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 703.74it/s, phase=train, Loss=0.1706, Acc=0.9594]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1664.30it/s, phase=val, Loss=1.2307, Acc=0.6791]
Training complete in 4m 59s
Best val Acc: 0.679095
Epoch 15/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 697.07it/s, phase=train, Loss=0.1670, Acc=0.9619]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1478.55it/s, phase=val, Loss=1.1951, Acc=0.6911]
Training complete in 5m 17s
Best val Acc: 0.691079
Epoch 16/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 703.49it/s, phase=train, Loss=0.1469, Acc=0.9664]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1495.68it/s, phase=val, Loss=1.1860, Acc=0.7111]
Training complete in 5m 36s
Best val Acc: 0.711052
Epoch 17/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 704.10it/s, phase=train, Loss=0.1651, Acc=0.9613]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1510.73it/s, phase=val, Loss=1.1693, Acc=0.6977]
Training complete in 5m 53s
Best val Acc: 0.711052
Epoch 18/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 705.58it/s, phase=train, Loss=0.1589, Acc=0.9646]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1628.71it/s, phase=val, Loss=1.0900, Acc=0.7097]
Training complete in 6m 11s
Best val Acc: 0.711052
Epoch 19/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 701.51it/s, phase=train, Loss=0.1366, Acc=0.9721]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1491.65it/s, phase=val, Loss=1.1671, Acc=0.7004]
Training complete in 6m 30s
Best val Acc: 0.711052
Epoch 20/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 704.21it/s, phase=train, Loss=0.0926, Acc=0.9828]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1506.08it/s, phase=val, Loss=1.0271, Acc=0.7403]
Training complete in 6m 48s
Best val Acc: 0.740346
Epoch 21/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 699.42it/s, phase=train, Loss=0.0641, Acc=0.9909]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1513.78it/s, phase=val, Loss=1.0108, Acc=0.7324]
Training complete in 7m 6s
Best val Acc: 0.740346
Epoch 22/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 701.72it/s, phase=train, Loss=0.0545, Acc=0.9929]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1427.37it/s, phase=val, Loss=0.9604, Acc=0.7510]
Training complete in 7m 24s
Best val Acc: 0.750999
Epoch 23/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 700.84it/s, phase=train, Loss=0.0521, Acc=0.9939]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1460.98it/s, phase=val, Loss=0.9878, Acc=0.7470]
Training complete in 7m 42s
Best val Acc: 0.750999
Epoch 24/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 697.43it/s, phase=train, Loss=0.0497, Acc=0.9937]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1538.59it/s, phase=val, Loss=0.9520, Acc=0.7577]
Training complete in 7m 60s
Best val Acc: 0.757656
Epoch 25/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 698.54it/s, phase=train, Loss=0.0471, Acc=0.9947]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1509.32it/s, phase=val, Loss=0.9313, Acc=0.7656]
Training complete in 8m 18s
Best val Acc: 0.765646
Epoch 26/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 707.34it/s, phase=train, Loss=0.0479, Acc=0.9943]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1513.78it/s, phase=val, Loss=0.9097, Acc=0.7630]
Training complete in 8m 36s
Best val Acc: 0.765646
Epoch 27/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 701.06it/s, phase=train, Loss=0.0434, Acc=0.9963]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1466.02it/s, phase=val, Loss=0.9159, Acc=0.7696]
Training complete in 8m 54s
Best val Acc: 0.769640
Epoch 28/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 689.27it/s, phase=train, Loss=0.0451, Acc=0.9945]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1587.39it/s, phase=val, Loss=0.9163, Acc=0.7710]
Training complete in 9m 12s
Best val Acc: 0.770972
Epoch 29/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 697.14it/s, phase=train, Loss=0.0424, Acc=0.9960]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1516.84it/s, phase=val, Loss=0.9073, Acc=0.7763]
Training complete in 9m 31s
Best val Acc: 0.776298
Training complete in 9m 31s
Best val Acc: 0.776298

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py  --gpu_ids 0  --name use_rn18_market_1 --use_rn18 --batchsize 32  --test_dir data/Market/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
19732it [00:33, 597.62it/s]
3368it [00:17, 194.20it/s]
Training complete in 0m 50.37s
use_rn18_market_1
torch.Size([3368, 512])
Rank@1:0.668646 Rank@5:0.844715 Rank@10:0.891924 mAP:0.394383

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID># Random Grayscale
'#' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0  --name use_rn18_market_2 --use_rn18 --batchsize 32  --data_dir data/Market/pytorch --rge 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <augmentations.RandomGrayscaleErasing object at 0x0000024D217D65F0>, RandomHorizontalFlip(p=0.5)]
14.623501062393188
Trainable parameters: 11825455
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 12185/12185 [00:19<00:00, 636.56it/s, phase=train, Loss=4.8850, Acc=0.1422]
100%|█████████████████████████████████████████| 751/751 [00:15<00:00, 49.80it/s, phase=val, Loss=3.9130, Acc=0.1864]
Training complete in 0m 34s
Best val Acc: 0.186418
Epoch 1/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 677.36it/s, phase=train, Loss=2.3215, Acc=0.4581]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1615.78it/s, phase=val, Loss=2.7005, Acc=0.3635]
Training complete in 0m 53s
Best val Acc: 0.363515
Epoch 2/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 674.05it/s, phase=train, Loss=1.4398, Acc=0.6290]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1600.92it/s, phase=val, Loss=2.1662, Acc=0.4767]
Training complete in 1m 12s
Best val Acc: 0.476698
Epoch 3/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 669.26it/s, phase=train, Loss=1.0037, Acc=0.7336]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1622.12it/s, phase=val, Loss=1.9809, Acc=0.5100]
Training complete in 1m 31s
Best val Acc: 0.509987
Epoch 4/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 668.88it/s, phase=train, Loss=0.7375, Acc=0.7972]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1623.90it/s, phase=val, Loss=1.6511, Acc=0.5792]
Training complete in 1m 50s
Best val Acc: 0.579228
Epoch 5/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 668.54it/s, phase=train, Loss=0.6001, Acc=0.8364]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1611.23it/s, phase=val, Loss=1.6082, Acc=0.5806]
Training complete in 2m 9s
Best val Acc: 0.580559
Epoch 6/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 678.24it/s, phase=train, Loss=0.5193, Acc=0.8542]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1601.83it/s, phase=val, Loss=1.5143, Acc=0.6138]
Training complete in 2m 27s
Best val Acc: 0.613848
Epoch 7/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 705.23it/s, phase=train, Loss=0.4632, Acc=0.8708]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1638.13it/s, phase=val, Loss=1.3754, Acc=0.6405]
Training complete in 2m 45s
Best val Acc: 0.640479
Epoch 8/29
100%|██████████████████████████████████| 12185/12185 [00:22<00:00, 546.81it/s, phase=train, Loss=0.3809, Acc=0.8968]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1702.57it/s, phase=val, Loss=1.3522, Acc=0.6538]
Training complete in 3m 8s
Best val Acc: 0.653795
Epoch 9/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 679.30it/s, phase=train, Loss=0.3380, Acc=0.9055]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1804.23it/s, phase=val, Loss=1.3165, Acc=0.6591]
Training complete in 3m 27s
Best val Acc: 0.659121
Epoch 10/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 713.49it/s, phase=train, Loss=0.3184, Acc=0.9133]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1783.46it/s, phase=val, Loss=1.2760, Acc=0.6711]
Training complete in 3m 45s
Best val Acc: 0.671105
Epoch 11/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 691.73it/s, phase=train, Loss=0.2921, Acc=0.9203]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1608.31it/s, phase=val, Loss=1.2379, Acc=0.7017]
Training complete in 4m 3s
Best val Acc: 0.701731
Epoch 12/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 660.75it/s, phase=train, Loss=0.2729, Acc=0.9254]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1587.38it/s, phase=val, Loss=1.2387, Acc=0.6831]
Training complete in 4m 22s
Best val Acc: 0.701731
Epoch 13/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 711.86it/s, phase=train, Loss=0.2482, Acc=0.9361]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1604.34it/s, phase=val, Loss=1.1419, Acc=0.6977]
Training complete in 4m 40s
Best val Acc: 0.701731
Epoch 14/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 674.26it/s, phase=train, Loss=0.2529, Acc=0.9331]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1635.80it/s, phase=val, Loss=1.1629, Acc=0.7111]
Training complete in 4m 58s
Best val Acc: 0.711052
Epoch 15/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 667.09it/s, phase=train, Loss=0.2243, Acc=0.9411]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1565.17it/s, phase=val, Loss=1.1687, Acc=0.7111]
Training complete in 5m 17s
Best val Acc: 0.711052
Epoch 16/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 673.69it/s, phase=train, Loss=0.2286, Acc=0.9420]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1574.03it/s, phase=val, Loss=1.1830, Acc=0.6818]
Training complete in 5m 36s
Best val Acc: 0.711052
Epoch 17/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 676.43it/s, phase=train, Loss=0.2181, Acc=0.9452]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1650.18it/s, phase=val, Loss=1.1206, Acc=0.7031]
Training complete in 5m 54s
Best val Acc: 0.711052
Epoch 18/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 663.02it/s, phase=train, Loss=0.2006, Acc=0.9488]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1645.15it/s, phase=val, Loss=1.1222, Acc=0.7097]
Training complete in 6m 13s
Best val Acc: 0.711052
Epoch 19/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 666.20it/s, phase=train, Loss=0.1796, Acc=0.9553]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1664.16it/s, phase=val, Loss=1.1138, Acc=0.6871]
Training complete in 6m 32s
Best val Acc: 0.711052
Epoch 20/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 673.03it/s, phase=train, Loss=0.1183, Acc=0.9736]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1536.36it/s, phase=val, Loss=0.9718, Acc=0.7337]
Training complete in 6m 51s
Best val Acc: 0.733688
Epoch 21/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 669.58it/s, phase=train, Loss=0.0910, Acc=0.9828]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1556.62it/s, phase=val, Loss=0.9359, Acc=0.7443]
Training complete in 7m 10s
Best val Acc: 0.744341
Epoch 22/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 672.53it/s, phase=train, Loss=0.0834, Acc=0.9833]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1591.11it/s, phase=val, Loss=0.9230, Acc=0.7350]
Training complete in 7m 29s
Best val Acc: 0.744341
Epoch 23/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 670.79it/s, phase=train, Loss=0.0751, Acc=0.9863]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1577.38it/s, phase=val, Loss=0.9188, Acc=0.7470]
Training complete in 7m 48s
Best val Acc: 0.747004
Epoch 24/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 674.60it/s, phase=train, Loss=0.0695, Acc=0.9891]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1618.18it/s, phase=val, Loss=0.9116, Acc=0.7403]
Training complete in 8m 6s
Best val Acc: 0.747004
Epoch 25/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 674.29it/s, phase=train, Loss=0.0689, Acc=0.9879]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1572.40it/s, phase=val, Loss=0.8734, Acc=0.7656]
Training complete in 8m 25s
Best val Acc: 0.765646
Epoch 26/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 664.21it/s, phase=train, Loss=0.0619, Acc=0.9902]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1526.47it/s, phase=val, Loss=0.8556, Acc=0.7723]
Training complete in 8m 44s
Best val Acc: 0.772304
Epoch 27/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 665.41it/s, phase=train, Loss=0.0658, Acc=0.9886]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1503.11it/s, phase=val, Loss=0.8796, Acc=0.7577]
Training complete in 9m 3s
Best val Acc: 0.772304
Epoch 28/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 667.47it/s, phase=train, Loss=0.0628, Acc=0.9896]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1526.38it/s, phase=val, Loss=0.8845, Acc=0.7683]
Training complete in 9m 22s
Best val Acc: 0.772304
Epoch 29/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 670.11it/s, phase=train, Loss=0.0596, Acc=0.9920]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1668.52it/s, phase=val, Loss=0.8632, Acc=0.7656]
Training complete in 9m 41s
Best val Acc: 0.772304
Training complete in 9m 41s
Best val Acc: 0.772304

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py  --gpu_ids 0  --name use_rn18_market_2 --use_rn18 --batchsize 32  --test_dir data/Market/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
19732it [00:33, 589.96it/s]
3368it [00:17, 190.01it/s]
Training complete in 0m 51.18s
use_rn18_market_2
torch.Size([3368, 512])
Rank@1:0.681710 Rank@5:0.854513 Rank@10:0.900238 mAP:0.410180

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID># Random Erasing
'#' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0  --name use_rn18_market_3 --use_rn18 --batchsize 32  --data_dir data/Market/pytorch --erasing_p 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <augmentations.RandomErasing object at 0x000002424232A650>, RandomHorizontalFlip(p=0.5)]
14.946472644805908
Trainable parameters: 11825455
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 12185/12185 [00:18<00:00, 647.55it/s, phase=train, Loss=5.2633, Acc=0.1075]
100%|█████████████████████████████████████████| 751/751 [00:15<00:00, 49.85it/s, phase=val, Loss=4.1453, Acc=0.1545]
Training complete in 0m 34s
Best val Acc: 0.154461
Epoch 1/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 700.56it/s, phase=train, Loss=2.8636, Acc=0.3694]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1550.41it/s, phase=val, Loss=2.8571, Acc=0.3382]
Training complete in 0m 52s
Best val Acc: 0.338216
Epoch 2/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 679.61it/s, phase=train, Loss=1.9229, Acc=0.5383]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1620.69it/s, phase=val, Loss=2.3956, Acc=0.4301]
Training complete in 1m 11s
Best val Acc: 0.430093
Epoch 3/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 686.04it/s, phase=train, Loss=1.4484, Acc=0.6395]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1529.16it/s, phase=val, Loss=1.8005, Acc=0.5353]
Training complete in 1m 29s
Best val Acc: 0.535286
Epoch 4/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 682.09it/s, phase=train, Loss=1.1659, Acc=0.7016]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1600.93it/s, phase=val, Loss=1.8864, Acc=0.5087]
Training complete in 1m 48s
Best val Acc: 0.535286
Epoch 5/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 688.30it/s, phase=train, Loss=0.9960, Acc=0.7435]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1601.23it/s, phase=val, Loss=1.5358, Acc=0.5965]
Training complete in 2m 6s
Best val Acc: 0.596538
Epoch 6/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 688.35it/s, phase=train, Loss=0.8548, Acc=0.7761]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1560.98it/s, phase=val, Loss=1.5060, Acc=0.6045]
Training complete in 2m 25s
Best val Acc: 0.604527
Epoch 7/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 692.62it/s, phase=train, Loss=0.7942, Acc=0.7883]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1546.89it/s, phase=val, Loss=1.4571, Acc=0.6152]
Training complete in 2m 43s
Best val Acc: 0.615180
Epoch 8/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 686.09it/s, phase=train, Loss=0.7012, Acc=0.8111]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1469.75it/s, phase=val, Loss=1.2685, Acc=0.6618]
Training complete in 3m 1s
Best val Acc: 0.661784
Epoch 9/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 684.32it/s, phase=train, Loss=0.6484, Acc=0.8260]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1594.13it/s, phase=val, Loss=1.2201, Acc=0.6698]
Training complete in 3m 20s
Best val Acc: 0.669774
Epoch 10/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 687.98it/s, phase=train, Loss=0.6226, Acc=0.8353]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1489.75it/s, phase=val, Loss=1.1798, Acc=0.6658]
Training complete in 3m 38s
Best val Acc: 0.669774
Epoch 11/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 689.05it/s, phase=train, Loss=0.5669, Acc=0.8478]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1552.72it/s, phase=val, Loss=1.2177, Acc=0.6698]
Training complete in 3m 57s
Best val Acc: 0.669774
Epoch 12/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 683.48it/s, phase=train, Loss=0.5639, Acc=0.8464]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1629.04it/s, phase=val, Loss=1.1442, Acc=0.6791]
Training complete in 4m 15s
Best val Acc: 0.679095
Epoch 13/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 683.89it/s, phase=train, Loss=0.5285, Acc=0.8584]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1627.71it/s, phase=val, Loss=1.0482, Acc=0.7230]
Training complete in 4m 34s
Best val Acc: 0.723036
Epoch 14/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 686.08it/s, phase=train, Loss=0.4981, Acc=0.8661]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1570.78it/s, phase=val, Loss=1.1498, Acc=0.6991]
Training complete in 4m 52s
Best val Acc: 0.723036
Epoch 15/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 686.84it/s, phase=train, Loss=0.4748, Acc=0.8707]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1580.70it/s, phase=val, Loss=0.9681, Acc=0.7297]
Training complete in 5m 11s
Best val Acc: 0.729694
Epoch 16/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 689.02it/s, phase=train, Loss=0.4653, Acc=0.8740]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1626.83it/s, phase=val, Loss=1.0698, Acc=0.6951]
Training complete in 5m 29s
Best val Acc: 0.729694
Epoch 17/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 687.75it/s, phase=train, Loss=0.4435, Acc=0.8799]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1512.66it/s, phase=val, Loss=1.0947, Acc=0.7150]
Training complete in 5m 47s
Best val Acc: 0.729694
Epoch 18/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 684.06it/s, phase=train, Loss=0.4179, Acc=0.8881]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1648.85it/s, phase=val, Loss=1.0347, Acc=0.7071]
Training complete in 6m 5s
Best val Acc: 0.729694
Epoch 19/29
100%|██████████████████████████████████| 12185/12185 [00:16<00:00, 724.73it/s, phase=train, Loss=0.4228, Acc=0.8883]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1747.48it/s, phase=val, Loss=0.9890, Acc=0.7204]
Training complete in 6m 23s
Best val Acc: 0.729694
Epoch 20/29
100%|██████████████████████████████████| 12185/12185 [00:21<00:00, 573.76it/s, phase=train, Loss=0.3075, Acc=0.9186]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1212.98it/s, phase=val, Loss=0.8307, Acc=0.7577]
Training complete in 6m 45s
Best val Acc: 0.757656
Epoch 21/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 689.68it/s, phase=train, Loss=0.2538, Acc=0.9348]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1620.93it/s, phase=val, Loss=0.7999, Acc=0.7696]
Training complete in 7m 3s
Best val Acc: 0.769640
Epoch 22/29
100%|██████████████████████████████████| 12185/12185 [00:16<00:00, 722.11it/s, phase=train, Loss=0.2255, Acc=0.9443]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1755.28it/s, phase=val, Loss=0.7888, Acc=0.7763]
Training complete in 7m 21s
Best val Acc: 0.776298
Epoch 23/29
100%|██████████████████████████████████| 12185/12185 [00:16<00:00, 723.66it/s, phase=train, Loss=0.2026, Acc=0.9499]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1509.66it/s, phase=val, Loss=0.7770, Acc=0.7736]
Training complete in 7m 38s
Best val Acc: 0.776298
Epoch 24/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 677.05it/s, phase=train, Loss=0.2032, Acc=0.9507]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1657.47it/s, phase=val, Loss=0.7611, Acc=0.7736]
Training complete in 7m 57s
Best val Acc: 0.776298
Epoch 25/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 713.53it/s, phase=train, Loss=0.1894, Acc=0.9533]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1646.56it/s, phase=val, Loss=0.7513, Acc=0.7710]
Training complete in 8m 14s
Best val Acc: 0.776298
Epoch 26/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 698.91it/s, phase=train, Loss=0.1861, Acc=0.9548]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1562.84it/s, phase=val, Loss=0.7621, Acc=0.7710]
Training complete in 8m 32s
Best val Acc: 0.776298
Epoch 27/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 691.71it/s, phase=train, Loss=0.1736, Acc=0.9609]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1614.68it/s, phase=val, Loss=0.7267, Acc=0.7750]
Training complete in 8m 51s
Best val Acc: 0.776298
Epoch 28/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 689.05it/s, phase=train, Loss=0.1737, Acc=0.9606]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1591.95it/s, phase=val, Loss=0.7707, Acc=0.7696]
Training complete in 9m 9s
Best val Acc: 0.776298
Epoch 29/29
100%|██████████████████████████████████| 12185/12185 [00:17<00:00, 697.59it/s, phase=train, Loss=0.1678, Acc=0.9617]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1556.81it/s, phase=val, Loss=0.7286, Acc=0.7830]
Training complete in 9m 27s
Best val Acc: 0.782956
Training complete in 9m 27s
Best val Acc: 0.782956

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py  --gpu_ids 0  --name use_rn18_market_3 --use_rn18 --batchsize 32  --test_dir data/Market/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
19732it [00:32, 604.31it/s]
3368it [00:17, 193.72it/s]
Training complete in 0m 50.04s
use_rn18_market_3
torch.Size([3368, 512])
Rank@1:0.711105 Rank@5:0.872328 Rank@10:0.920131 mAP:0.454128

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID># Foreground Background Augmentation
'#' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0  --name use_rn18_market_4 --use_rn18 --batchsize 32  --data_dir data/Market/pytorch --ours 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])]
14.759867429733276
Trainable parameters: 11825455
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 477.00it/s, phase=train, Loss=5.4177, Acc=0.0904]
100%|█████████████████████████████████████████| 751/751 [00:14<00:00, 50.12it/s, phase=val, Loss=4.3930, Acc=0.1358]
Training complete in 0m 41s
Best val Acc: 0.135819
Epoch 1/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 473.92it/s, phase=train, Loss=3.2330, Acc=0.3099]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1624.43it/s, phase=val, Loss=3.1477, Acc=0.3063]
Training complete in 1m 7s
Best val Acc: 0.306258
Epoch 2/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 482.39it/s, phase=train, Loss=2.2899, Acc=0.4624]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1516.84it/s, phase=val, Loss=2.4073, Acc=0.4221]
Training complete in 1m 33s
Best val Acc: 0.422104
Epoch 3/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 474.05it/s, phase=train, Loss=1.7541, Acc=0.5689]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1646.56it/s, phase=val, Loss=2.0681, Acc=0.4714]
Training complete in 1m 59s
Best val Acc: 0.471372
Epoch 4/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 477.31it/s, phase=train, Loss=1.4974, Acc=0.6230]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1657.95it/s, phase=val, Loss=1.7348, Acc=0.5419]
Training complete in 2m 26s
Best val Acc: 0.541944
Epoch 5/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 475.45it/s, phase=train, Loss=1.2689, Acc=0.6723]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1536.88it/s, phase=val, Loss=1.5441, Acc=0.5859]
Training complete in 2m 52s
Best val Acc: 0.585885
Epoch 6/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 477.29it/s, phase=train, Loss=1.1100, Acc=0.7082]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1587.77it/s, phase=val, Loss=1.5189, Acc=0.5846]
Training complete in 3m 18s
Best val Acc: 0.585885
Epoch 7/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 478.18it/s, phase=train, Loss=0.9855, Acc=0.7383]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1611.23it/s, phase=val, Loss=1.4529, Acc=0.6205]
Training complete in 3m 44s
Best val Acc: 0.620506
Epoch 8/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 476.82it/s, phase=train, Loss=0.9136, Acc=0.7633]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1587.39it/s, phase=val, Loss=1.2017, Acc=0.6525]
Training complete in 4m 10s
Best val Acc: 0.652463
Epoch 9/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 474.37it/s, phase=train, Loss=0.8701, Acc=0.7701]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1480.93it/s, phase=val, Loss=1.1815, Acc=0.6711]
Training complete in 4m 37s
Best val Acc: 0.671105
Epoch 10/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 478.05it/s, phase=train, Loss=0.7703, Acc=0.7969]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1595.94it/s, phase=val, Loss=1.2198, Acc=0.6711]
Training complete in 5m 3s
Best val Acc: 0.671105
Epoch 11/29
100%|██████████████████████████████████| 12185/12185 [00:38<00:00, 312.46it/s, phase=train, Loss=0.7696, Acc=0.8002]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 903.64it/s, phase=val, Loss=1.1363, Acc=0.6897]
Training complete in 5m 43s
Best val Acc: 0.689747
Epoch 12/29
100%|██████████████████████████████████| 12185/12185 [00:31<00:00, 391.69it/s, phase=train, Loss=0.7087, Acc=0.8149]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1517.51it/s, phase=val, Loss=1.0585, Acc=0.6831]
Training complete in 6m 15s
Best val Acc: 0.689747
Epoch 13/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 482.16it/s, phase=train, Loss=0.6636, Acc=0.8211]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1529.19it/s, phase=val, Loss=1.0690, Acc=0.6924]
Training complete in 6m 41s
Best val Acc: 0.692410
Epoch 14/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 484.00it/s, phase=train, Loss=0.6540, Acc=0.8241]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1532.31it/s, phase=val, Loss=1.0157, Acc=0.7137]
Training complete in 7m 7s
Best val Acc: 0.713715
Epoch 15/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 477.12it/s, phase=train, Loss=0.6213, Acc=0.8313]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1575.95it/s, phase=val, Loss=0.9188, Acc=0.7417]
Training complete in 7m 33s
Best val Acc: 0.741678
Epoch 16/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 474.01it/s, phase=train, Loss=0.6029, Acc=0.8379]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1604.35it/s, phase=val, Loss=0.9520, Acc=0.7257]
Training complete in 7m 59s
Best val Acc: 0.741678
Epoch 17/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 475.78it/s, phase=train, Loss=0.5702, Acc=0.8513]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1526.86it/s, phase=val, Loss=0.9432, Acc=0.7350]
Training complete in 8m 25s
Best val Acc: 0.741678
Epoch 18/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 471.84it/s, phase=train, Loss=0.5535, Acc=0.8516]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1532.31it/s, phase=val, Loss=0.9629, Acc=0.7310]
Training complete in 8m 52s
Best val Acc: 0.741678
Epoch 19/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 472.89it/s, phase=train, Loss=0.5704, Acc=0.8499]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1639.08it/s, phase=val, Loss=0.9412, Acc=0.7403]
Training complete in 9m 18s
Best val Acc: 0.741678
Epoch 20/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 474.86it/s, phase=train, Loss=0.4048, Acc=0.8944]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1521.75it/s, phase=val, Loss=0.8060, Acc=0.7523]
Training complete in 9m 45s
Best val Acc: 0.752330
Epoch 21/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 474.25it/s, phase=train, Loss=0.3251, Acc=0.9184]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1594.12it/s, phase=val, Loss=0.7592, Acc=0.7696]
Training complete in 10m 11s
Best val Acc: 0.769640
Epoch 22/29
100%|██████████████████████████████████| 12185/12185 [00:21<00:00, 557.41it/s, phase=train, Loss=0.3085, Acc=0.9225]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1663.08it/s, phase=val, Loss=0.7224, Acc=0.7896]
Training complete in 10m 34s
Best val Acc: 0.789614
Epoch 23/29
100%|██████████████████████████████████| 12185/12185 [00:26<00:00, 451.80it/s, phase=train, Loss=0.2946, Acc=0.9249]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1696.07it/s, phase=val, Loss=0.7114, Acc=0.7843]
Training complete in 11m 1s
Best val Acc: 0.789614
Epoch 24/29
100%|██████████████████████████████████| 12185/12185 [00:22<00:00, 542.49it/s, phase=train, Loss=0.2748, Acc=0.9307]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1790.19it/s, phase=val, Loss=0.7276, Acc=0.7750]
Training complete in 11m 24s
Best val Acc: 0.789614
Epoch 25/29
100%|██████████████████████████████████| 12185/12185 [00:21<00:00, 558.54it/s, phase=train, Loss=0.2650, Acc=0.9317]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1604.61it/s, phase=val, Loss=0.6863, Acc=0.8043]
Training complete in 11m 47s
Best val Acc: 0.804261
Epoch 26/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 476.48it/s, phase=train, Loss=0.2609, Acc=0.9351]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1499.23it/s, phase=val, Loss=0.6914, Acc=0.7923]
Training complete in 12m 13s
Best val Acc: 0.804261
Epoch 27/29
100%|██████████████████████████████████| 12185/12185 [00:25<00:00, 476.01it/s, phase=train, Loss=0.2492, Acc=0.9376]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1774.17it/s, phase=val, Loss=0.6748, Acc=0.7989]
Training complete in 12m 39s
Best val Acc: 0.804261
Epoch 28/29
100%|██████████████████████████████████| 12185/12185 [00:28<00:00, 432.94it/s, phase=train, Loss=0.2466, Acc=0.9389]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1523.72it/s, phase=val, Loss=0.6593, Acc=0.8016]
Training complete in 13m 8s
Best val Acc: 0.804261
Epoch 29/29
100%|██████████████████████████████████| 12185/12185 [00:28<00:00, 422.20it/s, phase=train, Loss=0.2405, Acc=0.9394]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1568.61it/s, phase=val, Loss=0.6858, Acc=0.7949]
Training complete in 13m 38s
Best val Acc: 0.804261
Training complete in 13m 38s
Best val Acc: 0.804261

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py  --gpu_ids 0  --name use_rn18_market_4 --use_rn18 --batchsize 32  --test_dir data/Market/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
19732it [00:34, 568.54it/s]
3368it [00:17, 187.91it/s]
Training complete in 0m 52.64s
use_rn18_market_4
torch.Size([3368, 512])
Rank@1:0.713777 Rank@5:0.871140 Rank@10:0.919537 mAP:0.469497

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>###########################################################
'###########################################################' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>## EfficientNet
'##' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0 --name eff_market_1 --use_efficient --batchsize 32  --data_dir data/Market/pytorch --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), RandomHorizontalFlip(p=0.5)]
15.201187372207642
Loaded pretrained weights for efficientnet-b4
Trainable parameters: 20645919
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 12185/12185 [00:43<00:00, 282.54it/s, phase=train, Loss=4.1362, Acc=0.2589]
100%|█████████████████████████████████████████| 751/751 [00:15<00:00, 47.16it/s, phase=val, Loss=2.3658, Acc=0.4461]
Training complete in 0m 59s
Best val Acc: 0.446072
Epoch 1/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 297.72it/s, phase=train, Loss=0.9897, Acc=0.7556]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1001.16it/s, phase=val, Loss=1.1594, Acc=0.6778]
Training complete in 1m 41s
Best val Acc: 0.677763
Epoch 2/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 299.02it/s, phase=train, Loss=0.3720, Acc=0.8993]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1018.79it/s, phase=val, Loss=0.8227, Acc=0.7736]
Training complete in 2m 23s
Best val Acc: 0.773635
Epoch 3/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 300.65it/s, phase=train, Loss=0.1848, Acc=0.9536]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1035.63it/s, phase=val, Loss=0.7315, Acc=0.8003]
Training complete in 3m 5s
Best val Acc: 0.800266
Epoch 4/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 297.58it/s, phase=train, Loss=0.1107, Acc=0.9750]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1066.50it/s, phase=val, Loss=0.6584, Acc=0.8202]
Training complete in 3m 47s
Best val Acc: 0.820240
Epoch 5/29
100%|██████████████████████████████████| 12185/12185 [00:41<00:00, 296.26it/s, phase=train, Loss=0.0721, Acc=0.9873]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1045.73it/s, phase=val, Loss=0.6165, Acc=0.8402]
Training complete in 4m 29s
Best val Acc: 0.840213
Epoch 6/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 298.69it/s, phase=train, Loss=0.0605, Acc=0.9909]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1021.54it/s, phase=val, Loss=0.5646, Acc=0.8495]
Training complete in 5m 11s
Best val Acc: 0.849534
Epoch 7/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 298.34it/s, phase=train, Loss=0.0549, Acc=0.9929]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1044.95it/s, phase=val, Loss=0.5744, Acc=0.8562]
Training complete in 5m 53s
Best val Acc: 0.856192
Epoch 8/29
100%|██████████████████████████████████| 12185/12185 [00:41<00:00, 296.76it/s, phase=train, Loss=0.0453, Acc=0.9952]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1025.73it/s, phase=val, Loss=0.5685, Acc=0.8415]
Training complete in 6m 35s
Best val Acc: 0.856192
Epoch 9/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 300.31it/s, phase=train, Loss=0.0444, Acc=0.9957]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 969.38it/s, phase=val, Loss=0.5224, Acc=0.8722]
Training complete in 7m 17s
Best val Acc: 0.872170
Epoch 10/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 300.65it/s, phase=train, Loss=0.0412, Acc=0.9960]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1021.00it/s, phase=val, Loss=0.5412, Acc=0.8628]
Training complete in 7m 59s
Best val Acc: 0.872170
Epoch 11/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 301.13it/s, phase=train, Loss=0.0431, Acc=0.9959]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1215.87it/s, phase=val, Loss=0.5795, Acc=0.8562]
Training complete in 8m 40s
Best val Acc: 0.872170
Epoch 12/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 299.50it/s, phase=train, Loss=0.0414, Acc=0.9963]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1044.86it/s, phase=val, Loss=0.5294, Acc=0.8748]
Training complete in 9m 22s
Best val Acc: 0.874834
Epoch 13/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 298.91it/s, phase=train, Loss=0.0374, Acc=0.9974]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1015.24it/s, phase=val, Loss=0.5063, Acc=0.8762]
Training complete in 10m 3s
Best val Acc: 0.876165
Epoch 14/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 299.85it/s, phase=train, Loss=0.0381, Acc=0.9966]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1068.32it/s, phase=val, Loss=0.5337, Acc=0.8775]
Training complete in 10m 45s
Best val Acc: 0.877497
Epoch 15/29
100%|██████████████████████████████████| 12185/12185 [00:41<00:00, 296.77it/s, phase=train, Loss=0.0386, Acc=0.9970]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1045.60it/s, phase=val, Loss=0.5008, Acc=0.8735]
Training complete in 11m 27s
Best val Acc: 0.877497
Epoch 16/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 300.65it/s, phase=train, Loss=0.0371, Acc=0.9972]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1054.73it/s, phase=val, Loss=0.5017, Acc=0.8762]
Training complete in 12m 8s
Best val Acc: 0.877497
Epoch 17/29
100%|██████████████████████████████████| 12185/12185 [00:40<00:00, 299.73it/s, phase=train, Loss=0.0370, Acc=0.9970]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1019.31it/s, phase=val, Loss=0.5328, Acc=0.8735]
Training complete in 12m 50s
Best val Acc: 0.877497
Epoch 18/29
100%|██████████████████████████████████| 12185/12185 [00:41<00:00, 296.85it/s, phase=train, Loss=0.0362, Acc=0.9973]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1009.18it/s, phase=val, Loss=0.5108, Acc=0.8802]
Training complete in 13m 32s
Best val Acc: 0.880160
Epoch 19/29
100%|██████████████████████████████████| 12185/12185 [00:35<00:00, 346.16it/s, phase=train, Loss=0.0366, Acc=0.9971]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1205.68it/s, phase=val, Loss=0.5278, Acc=0.8788]
Training complete in 14m 8s
Best val Acc: 0.880160
Epoch 20/29
100%|██████████████████████████████████| 12185/12185 [00:37<00:00, 326.80it/s, phase=train, Loss=0.0297, Acc=0.9978]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1259.34it/s, phase=val, Loss=0.4812, Acc=0.8868]
Training complete in 14m 46s
Best val Acc: 0.886818
Epoch 21/29
100%|██████████████████████████████████| 12185/12185 [00:33<00:00, 366.82it/s, phase=train, Loss=0.0261, Acc=0.9978]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1311.13it/s, phase=val, Loss=0.4732, Acc=0.8881]
Training complete in 15m 21s
Best val Acc: 0.888149
Epoch 22/29
100%|██████████████████████████████████| 12185/12185 [00:43<00:00, 282.42it/s, phase=train, Loss=0.0239, Acc=0.9977]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 839.86it/s, phase=val, Loss=0.4615, Acc=0.8935]
Training complete in 16m 5s
Best val Acc: 0.893475
Epoch 23/29
100%|██████████████████████████████████| 12185/12185 [00:41<00:00, 295.71it/s, phase=train, Loss=0.0229, Acc=0.9979]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 700.17it/s, phase=val, Loss=0.4644, Acc=0.8935]
Training complete in 16m 47s
Best val Acc: 0.893475
Epoch 24/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.32it/s, phase=train, Loss=0.0229, Acc=0.9979]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 904.75it/s, phase=val, Loss=0.4549, Acc=0.8948]
Training complete in 17m 35s
Best val Acc: 0.894807
Epoch 25/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 259.49it/s, phase=train, Loss=0.0236, Acc=0.9979]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 890.10it/s, phase=val, Loss=0.4621, Acc=0.8921]
Training complete in 18m 23s
Best val Acc: 0.894807
Epoch 26/29
100%|██████████████████████████████████| 12185/12185 [00:47<00:00, 258.16it/s, phase=train, Loss=0.0230, Acc=0.9977]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 889.61it/s, phase=val, Loss=0.4681, Acc=0.8881]
Training complete in 19m 11s
Best val Acc: 0.894807
Epoch 27/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 265.41it/s, phase=train, Loss=0.0241, Acc=0.9979]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 817.23it/s, phase=val, Loss=0.4633, Acc=0.8895]
Training complete in 19m 58s
Best val Acc: 0.894807
Epoch 28/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 267.50it/s, phase=train, Loss=0.0233, Acc=0.9977]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 967.57it/s, phase=val, Loss=0.4679, Acc=0.8948]
Training complete in 20m 45s
Best val Acc: 0.894807
Epoch 29/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.83it/s, phase=train, Loss=0.0237, Acc=0.9979]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 800.68it/s, phase=val, Loss=0.4551, Acc=0.8975]
Training complete in 21m 33s
Best val Acc: 0.897470
Training complete in 21m 33s
Best val Acc: 0.897470

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py --gpu_ids 0 --name eff_market_1 --use_efficient  --batchsize 32  --test_dir data/Market/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Loaded pretrained weights for efficientnet-b4
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
19732it [01:04, 308.03it/s]
3368it [00:23, 140.47it/s]
Training complete in 1m 28.04s
eff_market_1
torch.Size([3368, 512])
Rank@1:0.829869 Rank@5:0.933492 Rank@10:0.959620 mAP:0.620462

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0 --name eff_market_2 --use_efficient --batchsize 32  --data_dir data/Market/pytorch --rge 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <augmentations.RandomGrayscaleErasing object at 0x0000021EFAC42620>, RandomHorizontalFlip(p=0.5)]
16.079448223114014
Loaded pretrained weights for efficientnet-b4
Trainable parameters: 20645919
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 12185/12185 [00:50<00:00, 241.92it/s, phase=train, Loss=4.3295, Acc=0.2322]
100%|█████████████████████████████████████████| 751/751 [00:16<00:00, 46.23it/s, phase=val, Loss=2.5750, Acc=0.4248]
Training complete in 1m 7s
Best val Acc: 0.424767
Epoch 1/29
100%|██████████████████████████████████| 12185/12185 [00:48<00:00, 249.95it/s, phase=train, Loss=1.1536, Acc=0.7174]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 905.71it/s, phase=val, Loss=1.2967, Acc=0.6591]
Training complete in 1m 57s
Best val Acc: 0.659121
Epoch 2/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 263.90it/s, phase=train, Loss=0.4763, Acc=0.8742]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 896.42it/s, phase=val, Loss=0.9796, Acc=0.7270]
Training complete in 2m 44s
Best val Acc: 0.727031
Epoch 3/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 260.55it/s, phase=train, Loss=0.2567, Acc=0.9341]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 859.17it/s, phase=val, Loss=0.8091, Acc=0.7776]
Training complete in 3m 32s
Best val Acc: 0.777630
Epoch 4/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 266.83it/s, phase=train, Loss=0.1713, Acc=0.9576]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 922.30it/s, phase=val, Loss=0.7113, Acc=0.7963]
Training complete in 4m 19s
Best val Acc: 0.796272
Epoch 5/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 260.77it/s, phase=train, Loss=0.1174, Acc=0.9746]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 874.08it/s, phase=val, Loss=0.6700, Acc=0.8189]
Training complete in 5m 7s
Best val Acc: 0.818908
Epoch 6/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 262.90it/s, phase=train, Loss=0.0925, Acc=0.9815]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 919.01it/s, phase=val, Loss=0.6369, Acc=0.8136]
Training complete in 5m 54s
Best val Acc: 0.818908
Epoch 7/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 263.37it/s, phase=train, Loss=0.0731, Acc=0.9870]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 854.46it/s, phase=val, Loss=0.6354, Acc=0.8349]
Training complete in 6m 42s
Best val Acc: 0.834887
Epoch 8/29
100%|██████████████████████████████████| 12185/12185 [00:48<00:00, 251.75it/s, phase=train, Loss=0.0711, Acc=0.9871]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 913.26it/s, phase=val, Loss=0.6158, Acc=0.8375]
Training complete in 7m 31s
Best val Acc: 0.837550
Epoch 9/29
100%|██████████████████████████████████| 12185/12185 [00:47<00:00, 259.25it/s, phase=train, Loss=0.0537, Acc=0.9920]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 761.45it/s, phase=val, Loss=0.5990, Acc=0.8509]
Training complete in 8m 20s
Best val Acc: 0.850866
Epoch 10/29
100%|██████████████████████████████████| 12185/12185 [00:47<00:00, 258.20it/s, phase=train, Loss=0.0548, Acc=0.9928]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 884.37it/s, phase=val, Loss=0.5187, Acc=0.8695]
Training complete in 9m 9s
Best val Acc: 0.869507
Epoch 11/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.07it/s, phase=train, Loss=0.0485, Acc=0.9947]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 895.58it/s, phase=val, Loss=0.5329, Acc=0.8562]
Training complete in 9m 56s
Best val Acc: 0.869507
Epoch 12/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 262.93it/s, phase=train, Loss=0.0484, Acc=0.9950]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 842.82it/s, phase=val, Loss=0.5215, Acc=0.8695]
Training complete in 10m 44s
Best val Acc: 0.869507
Epoch 13/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.80it/s, phase=train, Loss=0.0439, Acc=0.9960]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 860.57it/s, phase=val, Loss=0.5135, Acc=0.8668]
Training complete in 11m 31s
Best val Acc: 0.869507
Epoch 14/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 265.44it/s, phase=train, Loss=0.0438, Acc=0.9963]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 922.51it/s, phase=val, Loss=0.5045, Acc=0.8708]
Training complete in 12m 18s
Best val Acc: 0.870839
Epoch 15/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.29it/s, phase=train, Loss=0.0455, Acc=0.9956]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 866.01it/s, phase=val, Loss=0.5309, Acc=0.8722]
Training complete in 13m 6s
Best val Acc: 0.872170
Epoch 16/29
100%|██████████████████████████████████| 12185/12185 [00:47<00:00, 256.93it/s, phase=train, Loss=0.0421, Acc=0.9968]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 868.20it/s, phase=val, Loss=0.5004, Acc=0.8842]
Training complete in 13m 55s
Best val Acc: 0.884154
Epoch 17/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.83it/s, phase=train, Loss=0.0409, Acc=0.9970]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 907.18it/s, phase=val, Loss=0.4983, Acc=0.8708]
Training complete in 14m 42s
Best val Acc: 0.884154
Epoch 18/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 262.69it/s, phase=train, Loss=0.0424, Acc=0.9966]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 877.14it/s, phase=val, Loss=0.5182, Acc=0.8682]
Training complete in 15m 30s
Best val Acc: 0.884154
Epoch 19/29
100%|██████████████████████████████████| 12185/12185 [00:48<00:00, 251.94it/s, phase=train, Loss=0.0442, Acc=0.9964]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 815.17it/s, phase=val, Loss=0.5134, Acc=0.8682]
Training complete in 16m 20s
Best val Acc: 0.884154
Epoch 20/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.52it/s, phase=train, Loss=0.0341, Acc=0.9971]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 898.08it/s, phase=val, Loss=0.4726, Acc=0.8815]
Training complete in 17m 7s
Best val Acc: 0.884154
Epoch 21/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 265.78it/s, phase=train, Loss=0.0303, Acc=0.9975]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 796.73it/s, phase=val, Loss=0.4652, Acc=0.8815]
Training complete in 17m 54s
Best val Acc: 0.884154
Epoch 22/29
100%|██████████████████████████████████| 12185/12185 [00:47<00:00, 254.01it/s, phase=train, Loss=0.0273, Acc=0.9975]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 912.80it/s, phase=val, Loss=0.4554, Acc=0.8788]
Training complete in 18m 43s
Best val Acc: 0.884154
Epoch 23/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 263.06it/s, phase=train, Loss=0.0267, Acc=0.9976]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 927.92it/s, phase=val, Loss=0.4669, Acc=0.8788]
Training complete in 19m 30s
Best val Acc: 0.884154
Epoch 24/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 264.15it/s, phase=train, Loss=0.0255, Acc=0.9975]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 919.28it/s, phase=val, Loss=0.4511, Acc=0.8815]
Training complete in 20m 17s
Best val Acc: 0.884154
Epoch 25/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 263.33it/s, phase=train, Loss=0.0256, Acc=0.9978]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 843.12it/s, phase=val, Loss=0.4645, Acc=0.8802]
Training complete in 21m 4s
Best val Acc: 0.884154
Epoch 26/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 260.92it/s, phase=train, Loss=0.0251, Acc=0.9978]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 879.21it/s, phase=val, Loss=0.4558, Acc=0.8802]
Training complete in 21m 52s
Best val Acc: 0.884154
Epoch 27/29
100%|██████████████████████████████████| 12185/12185 [00:34<00:00, 353.27it/s, phase=train, Loss=0.0256, Acc=0.9975]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 848.40it/s, phase=val, Loss=0.4574, Acc=0.8775]
Training complete in 22m 28s
Best val Acc: 0.884154
Epoch 28/29
100%|██████████████████████████████████| 12185/12185 [00:43<00:00, 281.95it/s, phase=train, Loss=0.0251, Acc=0.9979]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1304.87it/s, phase=val, Loss=0.4547, Acc=0.8802]
Training complete in 23m 11s
Best val Acc: 0.884154
Epoch 29/29
100%|██████████████████████████████████| 12185/12185 [00:34<00:00, 354.55it/s, phase=train, Loss=0.0271, Acc=0.9971]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1220.87it/s, phase=val, Loss=0.4522, Acc=0.8855]
Training complete in 23m 47s
Best val Acc: 0.885486
Training complete in 23m 47s
Best val Acc: 0.885486

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py --gpu_ids 0 --name eff_market_2 --use_efficient  --batchsize 32  --test_dir data/Market/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Loaded pretrained weights for efficientnet-b4
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
19732it [01:03, 312.97it/s]
3368it [00:21, 154.11it/s]
Training complete in 1m 24.91s
eff_market_2
torch.Size([3368, 512])
Rank@1:0.836995 Rank@5:0.938539 Rank@10:0.961401 mAP:0.622822

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0 --name eff_market_3 --use_efficient --batchsize 32  --data_dir data/Market/pytorch --erasing_p 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <augmentations.RandomErasing object at 0x0000022DF5B42620>, RandomHorizontalFlip(p=0.5)]
16.102831602096558
Loaded pretrained weights for efficientnet-b4
Trainable parameters: 20645919
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 12185/12185 [01:03<00:00, 192.77it/s, phase=train, Loss=4.5363, Acc=0.2025]
100%|█████████████████████████████████████████| 751/751 [00:16<00:00, 46.70it/s, phase=val, Loss=2.7250, Acc=0.4008]
Training complete in 1m 20s
Best val Acc: 0.400799
Epoch 1/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 262.26it/s, phase=train, Loss=1.4739, Acc=0.6451]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 778.44it/s, phase=val, Loss=1.3804, Acc=0.6312]
Training complete in 2m 7s
Best val Acc: 0.631158
Epoch 2/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 259.96it/s, phase=train, Loss=0.7341, Acc=0.8131]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 865.02it/s, phase=val, Loss=0.9267, Acc=0.7443]
Training complete in 2m 56s
Best val Acc: 0.744341
Epoch 3/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 260.98it/s, phase=train, Loss=0.4700, Acc=0.8771]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 874.59it/s, phase=val, Loss=0.7173, Acc=0.7870]
Training complete in 3m 44s
Best val Acc: 0.786951
Epoch 4/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 263.36it/s, phase=train, Loss=0.3456, Acc=0.9106]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 889.61it/s, phase=val, Loss=0.7242, Acc=0.7883]
Training complete in 4m 31s
Best val Acc: 0.788282
Epoch 5/29
100%|██████████████████████████████████| 12185/12185 [00:47<00:00, 258.52it/s, phase=train, Loss=0.2836, Acc=0.9265]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 929.47it/s, phase=val, Loss=0.6961, Acc=0.8083]
Training complete in 5m 19s
Best val Acc: 0.808256
Epoch 6/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 264.91it/s, phase=train, Loss=0.2276, Acc=0.9431]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 867.43it/s, phase=val, Loss=0.5914, Acc=0.8282]
Training complete in 6m 7s
Best val Acc: 0.828229
Epoch 7/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 264.86it/s, phase=train, Loss=0.2106, Acc=0.9494]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 889.61it/s, phase=val, Loss=0.5905, Acc=0.8375]
Training complete in 6m 54s
Best val Acc: 0.837550
Epoch 8/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.59it/s, phase=train, Loss=0.1870, Acc=0.9572]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 903.41it/s, phase=val, Loss=0.5949, Acc=0.8216]
Training complete in 7m 41s
Best val Acc: 0.837550
Epoch 9/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 263.63it/s, phase=train, Loss=0.1671, Acc=0.9620]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 860.06it/s, phase=val, Loss=0.5991, Acc=0.8229]
Training complete in 8m 29s
Best val Acc: 0.837550
Epoch 10/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 266.38it/s, phase=train, Loss=0.1560, Acc=0.9642]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 802.13it/s, phase=val, Loss=0.5336, Acc=0.8389]
Training complete in 9m 16s
Best val Acc: 0.838881
Epoch 11/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 263.00it/s, phase=train, Loss=0.1366, Acc=0.9682]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 869.13it/s, phase=val, Loss=0.4890, Acc=0.8549]
Training complete in 10m 4s
Best val Acc: 0.854860
Epoch 12/29
100%|██████████████████████████████████| 12185/12185 [00:47<00:00, 259.06it/s, phase=train, Loss=0.1409, Acc=0.9680]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 877.14it/s, phase=val, Loss=0.5079, Acc=0.8562]
Training complete in 10m 52s
Best val Acc: 0.856192
Epoch 13/29
100%|██████████████████████████████████| 12185/12185 [00:47<00:00, 257.15it/s, phase=train, Loss=0.1258, Acc=0.9728]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 911.21it/s, phase=val, Loss=0.4586, Acc=0.8802]
Training complete in 11m 41s
Best val Acc: 0.880160
Epoch 14/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 264.91it/s, phase=train, Loss=0.1239, Acc=0.9723]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 890.48it/s, phase=val, Loss=0.4461, Acc=0.8708]
Training complete in 12m 27s
Best val Acc: 0.880160
Epoch 15/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 266.44it/s, phase=train, Loss=0.1124, Acc=0.9766]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 912.71it/s, phase=val, Loss=0.4472, Acc=0.8655]
Training complete in 13m 14s
Best val Acc: 0.880160
Epoch 16/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 266.53it/s, phase=train, Loss=0.1235, Acc=0.9730]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 915.42it/s, phase=val, Loss=0.4538, Acc=0.8722]
Training complete in 14m 1s
Best val Acc: 0.880160
Epoch 17/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 263.44it/s, phase=train, Loss=0.1150, Acc=0.9762]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 884.85it/s, phase=val, Loss=0.4787, Acc=0.8722]
Training complete in 14m 48s
Best val Acc: 0.880160
Epoch 18/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 262.37it/s, phase=train, Loss=0.1098, Acc=0.9782]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 898.44it/s, phase=val, Loss=0.4737, Acc=0.8735]
Training complete in 15m 35s
Best val Acc: 0.880160
Epoch 19/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 265.06it/s, phase=train, Loss=0.1058, Acc=0.9796]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 800.53it/s, phase=val, Loss=0.4435, Acc=0.8708]
Training complete in 16m 23s
Best val Acc: 0.880160
Epoch 20/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 263.87it/s, phase=train, Loss=0.0823, Acc=0.9849]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 883.33it/s, phase=val, Loss=0.3793, Acc=0.8921]
Training complete in 17m 10s
Best val Acc: 0.892144
Epoch 21/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.92it/s, phase=train, Loss=0.0705, Acc=0.9864]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 907.95it/s, phase=val, Loss=0.3673, Acc=0.8895]
Training complete in 17m 57s
Best val Acc: 0.892144
Epoch 22/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.76it/s, phase=train, Loss=0.0574, Acc=0.9900]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 905.09it/s, phase=val, Loss=0.3485, Acc=0.9001]
Training complete in 18m 45s
Best val Acc: 0.900133
Epoch 23/29
100%|██████████████████████████████████| 12185/12185 [00:47<00:00, 258.91it/s, phase=train, Loss=0.0566, Acc=0.9902]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 881.26it/s, phase=val, Loss=0.3570, Acc=0.8975]
Training complete in 19m 33s
Best val Acc: 0.900133
Epoch 24/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 264.05it/s, phase=train, Loss=0.0556, Acc=0.9895]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 909.00it/s, phase=val, Loss=0.3323, Acc=0.9041]
Training complete in 20m 20s
Best val Acc: 0.904128
Epoch 25/29
100%|██████████████████████████████████| 12185/12185 [00:45<00:00, 265.01it/s, phase=train, Loss=0.0547, Acc=0.9906]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 859.49it/s, phase=val, Loss=0.3423, Acc=0.9028]
Training complete in 21m 7s
Best val Acc: 0.904128
Epoch 26/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 264.01it/s, phase=train, Loss=0.0501, Acc=0.9920]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 918.41it/s, phase=val, Loss=0.3399, Acc=0.9041]
Training complete in 21m 54s
Best val Acc: 0.904128
Epoch 27/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.91it/s, phase=train, Loss=0.0536, Acc=0.9907]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 877.78it/s, phase=val, Loss=0.3445, Acc=0.9055]
Training complete in 22m 42s
Best val Acc: 0.905459
Epoch 28/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 261.64it/s, phase=train, Loss=0.0487, Acc=0.9917]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 772.46it/s, phase=val, Loss=0.3308, Acc=0.9081]
Training complete in 23m 30s
Best val Acc: 0.908123
Epoch 29/29
100%|██████████████████████████████████| 12185/12185 [00:46<00:00, 259.65it/s, phase=train, Loss=0.0465, Acc=0.9920]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 809.77it/s, phase=val, Loss=0.3313, Acc=0.9095]
Training complete in 24m 19s
Best val Acc: 0.909454
Training complete in 24m 19s
Best val Acc: 0.909454

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py --gpu_ids 0 --name eff_market_3 --use_efficient  --batchsize 32  --test_dir data/Market/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Loaded pretrained weights for efficientnet-b4
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
19732it [01:04, 306.67it/s]
3368it [00:24, 137.69it/s]
Training complete in 1m 28.81s
eff_market_3
torch.Size([3368, 512])
Rank@1:0.872031 Rank@5:0.951306 Rank@10:0.966449 mAP:0.687147

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0 --name eff_market_4 --use_efficient --batchsize 32  --data_dir data/Market/pytorch --ours 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])]
15.465653419494629
Loaded pretrained weights for efficientnet-b4
Trainable parameters: 20645919
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 12185/12185 [01:18<00:00, 154.51it/s, phase=train, Loss=4.7526, Acc=0.1739]
100%|█████████████████████████████████████████| 751/751 [00:14<00:00, 53.18it/s, phase=val, Loss=2.9824, Acc=0.3728]
Training complete in 1m 33s
Best val Acc: 0.372836
Epoch 1/29
100%|██████████████████████████████████| 12185/12185 [01:02<00:00, 195.62it/s, phase=train, Loss=1.7520, Acc=0.5895]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1258.67it/s, phase=val, Loss=1.5522, Acc=0.6085]
Training complete in 2m 36s
Best val Acc: 0.608522
Epoch 2/29
100%|██████████████████████████████████| 12185/12185 [00:50<00:00, 242.77it/s, phase=train, Loss=0.9181, Acc=0.7581]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 921.27it/s, phase=val, Loss=1.0211, Acc=0.7164]
Training complete in 3m 28s
Best val Acc: 0.716378
Epoch 3/29
100%|██████████████████████████████████| 12185/12185 [01:09<00:00, 175.73it/s, phase=train, Loss=0.6215, Acc=0.8354]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1262.54it/s, phase=val, Loss=0.8241, Acc=0.7497]
Training complete in 4m 38s
Best val Acc: 0.749667
Epoch 4/29
100%|██████████████████████████████████| 12185/12185 [01:12<00:00, 167.40it/s, phase=train, Loss=0.4850, Acc=0.8730]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 737.36it/s, phase=val, Loss=0.7482, Acc=0.7870]
Training complete in 5m 52s
Best val Acc: 0.786951
Epoch 5/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.40it/s, phase=train, Loss=0.3916, Acc=0.8977]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 751.51it/s, phase=val, Loss=0.6505, Acc=0.8162]
Training complete in 7m 8s
Best val Acc: 0.816245
Epoch 6/29
100%|██████████████████████████████████| 12185/12185 [01:13<00:00, 165.39it/s, phase=train, Loss=0.3128, Acc=0.9169]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 719.17it/s, phase=val, Loss=0.6636, Acc=0.8282]
Training complete in 8m 23s
Best val Acc: 0.828229
Epoch 7/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 164.09it/s, phase=train, Loss=0.2691, Acc=0.9324]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 716.00it/s, phase=val, Loss=0.5806, Acc=0.8362]
Training complete in 9m 39s
Best val Acc: 0.836218
Epoch 8/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 162.74it/s, phase=train, Loss=0.2503, Acc=0.9339]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 722.65it/s, phase=val, Loss=0.5508, Acc=0.8455]
Training complete in 10m 55s
Best val Acc: 0.845539
Epoch 9/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.45it/s, phase=train, Loss=0.2410, Acc=0.9374]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 709.00it/s, phase=val, Loss=0.5243, Acc=0.8402]
Training complete in 12m 11s
Best val Acc: 0.845539
Epoch 10/29
100%|██████████████████████████████████| 12185/12185 [01:13<00:00, 166.50it/s, phase=train, Loss=0.2146, Acc=0.9469]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 724.74it/s, phase=val, Loss=0.5371, Acc=0.8296]
Training complete in 13m 26s
Best val Acc: 0.845539
Epoch 11/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.14it/s, phase=train, Loss=0.2065, Acc=0.9504]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 724.23it/s, phase=val, Loss=0.5558, Acc=0.8402]
Training complete in 14m 42s
Best val Acc: 0.845539
Epoch 12/29
100%|██████████████████████████████████| 12185/12185 [01:13<00:00, 164.93it/s, phase=train, Loss=0.1959, Acc=0.9525]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 715.08it/s, phase=val, Loss=0.4968, Acc=0.8549]
Training complete in 15m 57s
Best val Acc: 0.854860
Epoch 13/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.93it/s, phase=train, Loss=0.1885, Acc=0.9554]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 719.19it/s, phase=val, Loss=0.4651, Acc=0.8602]
Training complete in 17m 13s
Best val Acc: 0.860186
Epoch 14/29
100%|██████████████████████████████████| 12185/12185 [01:13<00:00, 165.64it/s, phase=train, Loss=0.1702, Acc=0.9597]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 717.06it/s, phase=val, Loss=0.4578, Acc=0.8655]
Training complete in 18m 27s
Best val Acc: 0.865513
Epoch 15/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.59it/s, phase=train, Loss=0.1648, Acc=0.9612]
100%|████████████████████████████████████████| 751/751 [00:00<00:00, 755.40it/s, phase=val, Loss=0.4201, Acc=0.8655]
Training complete in 19m 43s
Best val Acc: 0.865513
Epoch 16/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.56it/s, phase=train, Loss=0.1433, Acc=0.9659]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 744.91it/s, phase=val, Loss=0.4083, Acc=0.8921]
Training complete in 20m 59s
Best val Acc: 0.892144
Epoch 17/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.88it/s, phase=train, Loss=0.1482, Acc=0.9659]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 728.96it/s, phase=val, Loss=0.4629, Acc=0.8642]
Training complete in 22m 14s
Best val Acc: 0.892144
Epoch 18/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.28it/s, phase=train, Loss=0.1517, Acc=0.9656]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 726.14it/s, phase=val, Loss=0.4470, Acc=0.8642]
Training complete in 23m 30s
Best val Acc: 0.892144
Epoch 19/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.02it/s, phase=train, Loss=0.1487, Acc=0.9654]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 711.17it/s, phase=val, Loss=0.4434, Acc=0.8708]
Training complete in 24m 47s
Best val Acc: 0.892144
Epoch 20/29
100%|██████████████████████████████████| 12185/12185 [01:13<00:00, 165.61it/s, phase=train, Loss=0.1087, Acc=0.9760]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 715.08it/s, phase=val, Loss=0.3192, Acc=0.8935]
Training complete in 26m 2s
Best val Acc: 0.893475
Epoch 21/29
100%|██████████████████████████████████| 12185/12185 [01:13<00:00, 165.41it/s, phase=train, Loss=0.0856, Acc=0.9831]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 717.80it/s, phase=val, Loss=0.3086, Acc=0.8948]
Training complete in 27m 17s
Best val Acc: 0.894807
Epoch 22/29
100%|██████████████████████████████████| 12185/12185 [01:15<00:00, 162.19it/s, phase=train, Loss=0.0846, Acc=0.9824]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 714.34it/s, phase=val, Loss=0.3061, Acc=0.8975]
Training complete in 28m 33s
Best val Acc: 0.897470
Epoch 23/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.87it/s, phase=train, Loss=0.0816, Acc=0.9813]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 726.32it/s, phase=val, Loss=0.3116, Acc=0.9001]
Training complete in 29m 49s
Best val Acc: 0.900133
Epoch 24/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.60it/s, phase=train, Loss=0.0772, Acc=0.9843]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 721.22it/s, phase=val, Loss=0.3015, Acc=0.9001]
Training complete in 31m 5s
Best val Acc: 0.900133
Epoch 25/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.16it/s, phase=train, Loss=0.0659, Acc=0.9876]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 719.19it/s, phase=val, Loss=0.2977, Acc=0.8988]
Training complete in 32m 21s
Best val Acc: 0.900133
Epoch 26/29
100%|██████████████████████████████████| 12185/12185 [01:14<00:00, 163.92it/s, phase=train, Loss=0.0650, Acc=0.9874]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 736.49it/s, phase=val, Loss=0.2865, Acc=0.9081]
Training complete in 33m 36s
Best val Acc: 0.908123
Epoch 27/29
100%|██████████████████████████████████| 12185/12185 [01:13<00:00, 165.08it/s, phase=train, Loss=0.0706, Acc=0.9859]
100%|████████████████████████████████████████| 751/751 [00:01<00:00, 708.51it/s, phase=val, Loss=0.2894, Acc=0.9068]
Training complete in 34m 51s
Best val Acc: 0.908123
Epoch 28/29
100%|██████████████████████████████████| 12185/12185 [01:09<00:00, 176.51it/s, phase=train, Loss=0.0631, Acc=0.9886]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1323.33it/s, phase=val, Loss=0.2848, Acc=0.9134]
Training complete in 36m 1s
Best val Acc: 0.913449
Epoch 29/29
100%|██████████████████████████████████| 12185/12185 [01:02<00:00, 195.25it/s, phase=train, Loss=0.0636, Acc=0.9886]
100%|███████████████████████████████████████| 751/751 [00:00<00:00, 1198.89it/s, phase=val, Loss=0.2849, Acc=0.9055]
Training complete in 37m 5s
Best val Acc: 0.913449
Training complete in 37m 5s
Best val Acc: 0.913449

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py --gpu_ids 0 --name eff_market_4 --use_efficient  --batchsize 32  --test_dir data/Market/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Loaded pretrained weights for efficientnet-b4
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
19732it [00:53, 371.81it/s]
3368it [00:22, 148.54it/s]
Training complete in 1m 15.75s
eff_market_4
torch.Size([3368, 512])
Rank@1:0.874109 Rank@5:0.952197 Rank@10:0.970606 mAP:0.698476

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>


(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>###########################################################
'###########################################################' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>###########################################################
'###########################################################' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>### DukeMTMC-reID
'###' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>###########################################################
'###########################################################' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>## ResNet18
'##' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0  --name use_rn18_duke_1 --use_rn18 --batchsize 32  --data_dir data/DukeMTMC-reID/pytorch --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), RandomHorizontalFlip(p=0.5)]
15.267892122268677
Trainable parameters: 11800318
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
 40%|████████▋             | 6272/15820 [00:20<00:26, 356.46it/s, phase=train, Loss=5.3390, A 40%|████████▊          100%|█████████████████████| 15820/15820 [00:46<00:00, 336.65it/s, phase=train, Loss=4.3713, Acc=0.2302]
100%|█████████████████████████████████████████| 702/702 [00:15<00:00, 46.59it/s, phase=val, Loss=3.2828, Acc=0.2678]
Training complete in 1m 2s
Best val Acc: 0.267806
Epoch 1/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 640.60it/s, phase=train, Loss=1.7689, Acc=0.5961]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1438.20it/s, phase=val, Loss=2.3185, Acc=0.4345]
Training complete in 1m 28s
Best val Acc: 0.434473
Epoch 2/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 641.71it/s, phase=train, Loss=1.0351, Acc=0.7516]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1488.69it/s, phase=val, Loss=1.8921, Acc=0.5427]
Training complete in 1m 53s
Best val Acc: 0.542735
Epoch 3/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 644.66it/s, phase=train, Loss=0.7047, Acc=0.8211]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1373.47it/s, phase=val, Loss=1.6136, Acc=0.5869]
Training complete in 2m 18s
Best val Acc: 0.586895
Epoch 4/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 641.73it/s, phase=train, Loss=0.5325, Acc=0.8635]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1302.33it/s, phase=val, Loss=1.6279, Acc=0.5940]
Training complete in 2m 44s
Best val Acc: 0.594017
Epoch 5/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 639.93it/s, phase=train, Loss=0.4416, Acc=0.8832]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1402.16it/s, phase=val, Loss=1.4884, Acc=0.6268]
Training complete in 3m 9s
Best val Acc: 0.626781
Epoch 6/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 644.61it/s, phase=train, Loss=0.3608, Acc=0.9037]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1412.16it/s, phase=val, Loss=1.3743, Acc=0.6467]
Training complete in 3m 34s
Best val Acc: 0.646724
Epoch 7/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 641.35it/s, phase=train, Loss=0.3147, Acc=0.9176]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1529.07it/s, phase=val, Loss=1.4225, Acc=0.6396]
Training complete in 3m 60s
Best val Acc: 0.646724
Epoch 8/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 636.26it/s, phase=train, Loss=0.2952, Acc=0.9242]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1355.24it/s, phase=val, Loss=1.3734, Acc=0.6239]
Training complete in 4m 25s
Best val Acc: 0.646724
Epoch 9/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 637.88it/s, phase=train, Loss=0.2732, Acc=0.9302]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1421.52it/s, phase=val, Loss=1.3815, Acc=0.6581]
Training complete in 4m 51s
Best val Acc: 0.658120
Epoch 10/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 644.20it/s, phase=train, Loss=0.2462, Acc=0.9378]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1483.15it/s, phase=val, Loss=1.3177, Acc=0.6724]
Training complete in 5m 16s
Best val Acc: 0.672365
Epoch 11/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 638.95it/s, phase=train, Loss=0.2069, Acc=0.9501]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1371.33it/s, phase=val, Loss=1.2099, Acc=0.6966]
Training complete in 5m 42s
Best val Acc: 0.696581
Epoch 12/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 641.54it/s, phase=train, Loss=0.1887, Acc=0.9560]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1496.47it/s, phase=val, Loss=1.1817, Acc=0.6952]
Training complete in 6m 7s
Best val Acc: 0.696581
Epoch 13/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 641.95it/s, phase=train, Loss=0.1967, Acc=0.9560]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1493.63it/s, phase=val, Loss=1.2484, Acc=0.6724]
Training complete in 6m 32s
Best val Acc: 0.696581
Epoch 14/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 639.01it/s, phase=train, Loss=0.2022, Acc=0.9511]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1389.79it/s, phase=val, Loss=1.2201, Acc=0.6667]
Training complete in 6m 57s
Best val Acc: 0.696581
Epoch 15/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 644.45it/s, phase=train, Loss=0.1780, Acc=0.9591]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1450.56it/s, phase=val, Loss=1.1306, Acc=0.7137]
Training complete in 7m 23s
Best val Acc: 0.713675
Epoch 16/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 639.72it/s, phase=train, Loss=0.1720, Acc=0.9617]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1496.47it/s, phase=val, Loss=1.2386, Acc=0.6952]
Training complete in 7m 48s
Best val Acc: 0.713675
Epoch 17/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 641.25it/s, phase=train, Loss=0.1617, Acc=0.9640]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1413.64it/s, phase=val, Loss=1.2175, Acc=0.6823]
Training complete in 8m 13s
Best val Acc: 0.713675
Epoch 18/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 637.75it/s, phase=train, Loss=0.1655, Acc=0.9641]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1386.92it/s, phase=val, Loss=1.2135, Acc=0.6895]
Training complete in 8m 39s
Best val Acc: 0.713675
Epoch 19/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 632.57it/s, phase=train, Loss=0.1560, Acc=0.9650]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1505.35it/s, phase=val, Loss=1.1276, Acc=0.7151]
Training complete in 9m 5s
Best val Acc: 0.715100
Epoch 20/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 642.40it/s, phase=train, Loss=0.0877, Acc=0.9857]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1630.71it/s, phase=val, Loss=0.9770, Acc=0.7507]
Training complete in 9m 30s
Best val Acc: 0.750712
Epoch 21/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 632.25it/s, phase=train, Loss=0.0655, Acc=0.9901]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1072.53it/s, phase=val, Loss=0.9593, Acc=0.7593]
Training complete in 9m 56s
Best val Acc: 0.759259
Epoch 22/29
100%|██████████████████████████████████| 15820/15820 [00:26<00:00, 587.89it/s, phase=train, Loss=0.0595, Acc=0.9921]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1044.23it/s, phase=val, Loss=0.9753, Acc=0.7536]
Training complete in 10m 23s
Best val Acc: 0.759259
Epoch 23/29
100%|██████████████████████████████████| 15820/15820 [00:23<00:00, 664.66it/s, phase=train, Loss=0.0494, Acc=0.9948]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1608.66it/s, phase=val, Loss=0.9501, Acc=0.7607]
Training complete in 10m 48s
Best val Acc: 0.760684
Epoch 24/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 652.46it/s, phase=train, Loss=0.0467, Acc=0.9953]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1465.23it/s, phase=val, Loss=0.9593, Acc=0.7521]
Training complete in 11m 13s
Best val Acc: 0.760684
Epoch 25/29
100%|██████████████████████████████████| 15820/15820 [00:23<00:00, 661.49it/s, phase=train, Loss=0.0449, Acc=0.9966]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1471.91it/s, phase=val, Loss=0.8848, Acc=0.7778]
Training complete in 11m 37s
Best val Acc: 0.777778
Epoch 26/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 638.53it/s, phase=train, Loss=0.0431, Acc=0.9973]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1483.82it/s, phase=val, Loss=0.8962, Acc=0.7764]
Training complete in 12m 3s
Best val Acc: 0.777778
Epoch 27/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 638.70it/s, phase=train, Loss=0.0431, Acc=0.9968]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1483.81it/s, phase=val, Loss=0.8979, Acc=0.7764]
Training complete in 12m 28s
Best val Acc: 0.777778
Epoch 28/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 637.34it/s, phase=train, Loss=0.0424, Acc=0.9967]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1415.01it/s, phase=val, Loss=0.9190, Acc=0.7621]
Training complete in 12m 53s
Best val Acc: 0.777778
Epoch 29/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 633.95it/s, phase=train, Loss=0.0417, Acc=0.9973]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1438.21it/s, phase=val, Loss=0.9282, Acc=0.7650]
Training complete in 13m 19s
Best val Acc: 0.777778
Training complete in 13m 19s
Best val Acc: 0.777778

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py  --gpu_ids 0  --name use_rn18_duke_1 --use_rn18 --batchsize 32  --test_dir data/DukeMTMC-reID/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
17661it [00:34, 516.42it/s]
2228it [00:16, 135.98it/s]
Training complete in 0m 50.59s
use_rn18_duke_1
torch.Size([2228, 512])
Rank@1:0.633752 Rank@5:0.780072 Rank@10:0.828097 mAP:0.401748

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0  --name use_rn18_duke_2 --use_rn18 --batchsize 32  --data_dir data/DukeMTMC-reID/pytorch --rge 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <augmentations.RandomGrayscaleErasing object at 0x000002902E5065C0>, RandomHorizontalFlip(p=0.5)]
15.087610960006714
Trainable parameters: 11800318
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 15820/15820 [00:26<00:00, 588.82it/s, phase=train, Loss=4.7372, Acc=0.1837]
100%|█████████████████████████████████████████| 702/702 [00:15<00:00, 46.79it/s, phase=val, Loss=3.5866, Acc=0.2336]
Training complete in 0m 42s
Best val Acc: 0.233618
Epoch 1/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 616.51it/s, phase=train, Loss=2.1433, Acc=0.5240]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1389.79it/s, phase=val, Loss=2.3970, Acc=0.4330]
Training complete in 1m 9s
Best val Acc: 0.433048
Epoch 2/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 618.68it/s, phase=train, Loss=1.2896, Acc=0.6908]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1424.45it/s, phase=val, Loss=2.1346, Acc=0.5028]
Training complete in 1m 35s
Best val Acc: 0.502849
Epoch 3/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 624.05it/s, phase=train, Loss=0.9186, Acc=0.7724]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1463.60it/s, phase=val, Loss=1.7824, Acc=0.5627]
Training complete in 2m 1s
Best val Acc: 0.562678
Epoch 4/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 621.69it/s, phase=train, Loss=0.6934, Acc=0.8259]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1465.23it/s, phase=val, Loss=1.6276, Acc=0.5897]
Training complete in 2m 27s
Best val Acc: 0.589744
Epoch 5/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 620.13it/s, phase=train, Loss=0.5973, Acc=0.8448]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1514.25it/s, phase=val, Loss=1.6775, Acc=0.5969]
Training complete in 2m 53s
Best val Acc: 0.596866
Epoch 6/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 620.62it/s, phase=train, Loss=0.5089, Acc=0.8690]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1392.55it/s, phase=val, Loss=1.5161, Acc=0.6439]
Training complete in 3m 19s
Best val Acc: 0.643875
Epoch 7/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 617.43it/s, phase=train, Loss=0.4469, Acc=0.8844]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1335.70it/s, phase=val, Loss=1.5573, Acc=0.6111]
Training complete in 3m 46s
Best val Acc: 0.643875
Epoch 8/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 618.81it/s, phase=train, Loss=0.4040, Acc=0.8931]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1420.74it/s, phase=val, Loss=1.5762, Acc=0.6140]
Training complete in 4m 12s
Best val Acc: 0.643875
Epoch 9/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 619.61it/s, phase=train, Loss=0.3563, Acc=0.9071]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1437.75it/s, phase=val, Loss=1.4421, Acc=0.6368]
Training complete in 4m 38s
Best val Acc: 0.643875
Epoch 10/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 620.89it/s, phase=train, Loss=0.3396, Acc=0.9098]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1450.09it/s, phase=val, Loss=1.4227, Acc=0.6296]
Training complete in 5m 4s
Best val Acc: 0.643875
Epoch 11/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 620.92it/s, phase=train, Loss=0.3131, Acc=0.9192]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1459.14it/s, phase=val, Loss=1.4338, Acc=0.6439]
Training complete in 5m 30s
Best val Acc: 0.643875
Epoch 12/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 629.95it/s, phase=train, Loss=0.3148, Acc=0.9189]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1582.39it/s, phase=val, Loss=1.3859, Acc=0.6652]
Training complete in 5m 56s
Best val Acc: 0.665242
Epoch 13/29
100%|██████████████████████████████████| 15820/15820 [00:28<00:00, 560.23it/s, phase=train, Loss=0.2741, Acc=0.9293]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1058.59it/s, phase=val, Loss=1.4176, Acc=0.6382]
Training complete in 6m 25s
Best val Acc: 0.665242
Epoch 14/29
100%|██████████████████████████████████| 15820/15820 [00:26<00:00, 590.03it/s, phase=train, Loss=0.2666, Acc=0.9307]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1453.23it/s, phase=val, Loss=1.5355, Acc=0.6268]
Training complete in 6m 52s
Best val Acc: 0.665242
Epoch 15/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 650.45it/s, phase=train, Loss=0.2676, Acc=0.9306]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1601.66it/s, phase=val, Loss=1.4231, Acc=0.6425]
Training complete in 7m 17s
Best val Acc: 0.665242
Epoch 16/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 622.85it/s, phase=train, Loss=0.2362, Acc=0.9430]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1578.81it/s, phase=val, Loss=1.3865, Acc=0.6524]
Training complete in 7m 43s
Best val Acc: 0.665242
Epoch 17/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 648.75it/s, phase=train, Loss=0.2031, Acc=0.9504]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1502.23it/s, phase=val, Loss=1.3247, Acc=0.6724]
Training complete in 8m 8s
Best val Acc: 0.672365
Epoch 18/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 619.01it/s, phase=train, Loss=0.2348, Acc=0.9410]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1443.19it/s, phase=val, Loss=1.3294, Acc=0.6453]
Training complete in 8m 34s
Best val Acc: 0.672365
Epoch 19/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 620.45it/s, phase=train, Loss=0.2127, Acc=0.9478]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1428.33it/s, phase=val, Loss=1.3576, Acc=0.6610]
Training complete in 9m 1s
Best val Acc: 0.672365
Epoch 20/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 618.59it/s, phase=train, Loss=0.1374, Acc=0.9709]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1468.29it/s, phase=val, Loss=1.1507, Acc=0.7009]
Training complete in 9m 27s
Best val Acc: 0.700855
Epoch 21/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 615.62it/s, phase=train, Loss=0.0952, Acc=0.9816]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1392.00it/s, phase=val, Loss=1.1315, Acc=0.7094]
Training complete in 9m 53s
Best val Acc: 0.709402
Epoch 22/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 618.99it/s, phase=train, Loss=0.0858, Acc=0.9838]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1405.67it/s, phase=val, Loss=1.1084, Acc=0.7279]
Training complete in 10m 20s
Best val Acc: 0.727920
Epoch 23/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 619.10it/s, phase=train, Loss=0.0797, Acc=0.9862]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1500.64it/s, phase=val, Loss=1.1020, Acc=0.7194]
Training complete in 10m 46s
Best val Acc: 0.727920
Epoch 24/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 614.73it/s, phase=train, Loss=0.0723, Acc=0.9885]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1447.99it/s, phase=val, Loss=1.0701, Acc=0.7265]
Training complete in 11m 12s
Best val Acc: 0.727920
Epoch 25/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 619.96it/s, phase=train, Loss=0.0693, Acc=0.9893]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1453.28it/s, phase=val, Loss=1.1029, Acc=0.7308]
Training complete in 11m 38s
Best val Acc: 0.730769
Epoch 26/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 623.85it/s, phase=train, Loss=0.0667, Acc=0.9905]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1409.33it/s, phase=val, Loss=1.0718, Acc=0.7379]
Training complete in 12m 4s
Best val Acc: 0.737892
Epoch 27/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 618.65it/s, phase=train, Loss=0.0665, Acc=0.9905]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1456.03it/s, phase=val, Loss=1.0656, Acc=0.7308]
Training complete in 12m 31s
Best val Acc: 0.737892
Epoch 28/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 619.97it/s, phase=train, Loss=0.0624, Acc=0.9914]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1381.29it/s, phase=val, Loss=1.0545, Acc=0.7365]
Training complete in 12m 57s
Best val Acc: 0.737892
Epoch 29/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 615.07it/s, phase=train, Loss=0.0605, Acc=0.9922]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1493.29it/s, phase=val, Loss=1.0705, Acc=0.7450]
Training complete in 13m 23s
Best val Acc: 0.745014
Training complete in 13m 23s
Best val Acc: 0.745014

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py  --gpu_ids 0  --name use_rn18_duke_2 --use_rn18 --batchsize 32  --test_dir data/DukeMTMC-reID/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
17661it [00:31, 558.26it/s]
2228it [00:16, 135.39it/s]
Training complete in 0m 48.10s
use_rn18_duke_2
torch.Size([2228, 512])
Rank@1:0.611759 Rank@5:0.773339 Rank@10:0.827199 mAP:0.395926

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0  --name use_rn18_duke_3 --use_rn18 --batchsize 32  --data_dir data/DukeMTMC-reID/pytorch --erasing_p 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <augmentations.RandomErasing object at 0x0000022BB730E620>, RandomHorizontalFlip(p=0.5)]
15.017998695373535
Trainable parameters: 11800318
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 15820/15820 [00:26<00:00, 598.61it/s, phase=train, Loss=4.8950, Acc=0.1651]
100%|█████████████████████████████████████████| 702/702 [00:15<00:00, 46.26it/s, phase=val, Loss=3.8249, Acc=0.2009]
Training complete in 0m 42s
Best val Acc: 0.200855
Epoch 1/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 635.52it/s, phase=train, Loss=2.4808, Acc=0.4616]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1402.00it/s, phase=val, Loss=2.4502, Acc=0.4145]
Training complete in 1m 7s
Best val Acc: 0.414530
Epoch 2/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 633.85it/s, phase=train, Loss=1.6089, Acc=0.6243]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1459.47it/s, phase=val, Loss=1.9403, Acc=0.5299]
Training complete in 1m 33s
Best val Acc: 0.529915
Epoch 3/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 629.47it/s, phase=train, Loss=1.2429, Acc=0.7013]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1571.23it/s, phase=val, Loss=1.7083, Acc=0.5698]
Training complete in 1m 59s
Best val Acc: 0.569801
Epoch 4/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 615.19it/s, phase=train, Loss=1.0132, Acc=0.7526]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1057.00it/s, phase=val, Loss=1.5274, Acc=0.6254]
Training complete in 2m 26s
Best val Acc: 0.625356
Epoch 5/29
100%|██████████████████████████████████| 15820/15820 [00:27<00:00, 580.70it/s, phase=train, Loss=0.8653, Acc=0.7832]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1354.51it/s, phase=val, Loss=1.5108, Acc=0.6097]
Training complete in 2m 53s
Best val Acc: 0.625356
Epoch 6/29
100%|██████████████████████████████████| 15820/15820 [00:23<00:00, 669.62it/s, phase=train, Loss=0.7657, Acc=0.8067]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1560.49it/s, phase=val, Loss=1.4946, Acc=0.6097]
Training complete in 3m 18s
Best val Acc: 0.625356
Epoch 7/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 633.95it/s, phase=train, Loss=0.7066, Acc=0.8198]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1470.34it/s, phase=val, Loss=1.3755, Acc=0.6296]
Training complete in 3m 43s
Best val Acc: 0.629630
Epoch 8/29
100%|██████████████████████████████████| 15820/15820 [00:24<00:00, 645.76it/s, phase=train, Loss=0.6388, Acc=0.8329]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1382.61it/s, phase=val, Loss=1.3364, Acc=0.6510]
Training complete in 4m 8s
Best val Acc: 0.650997
Epoch 9/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 617.32it/s, phase=train, Loss=0.6157, Acc=0.8408]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1487.86it/s, phase=val, Loss=1.3598, Acc=0.6382]
Training complete in 4m 35s
Best val Acc: 0.650997
Epoch 10/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 617.53it/s, phase=train, Loss=0.5697, Acc=0.8525]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1409.68it/s, phase=val, Loss=1.3489, Acc=0.6667]
Training complete in 5m 1s
Best val Acc: 0.666667
Epoch 11/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 617.66it/s, phase=train, Loss=0.5305, Acc=0.8657]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1344.53it/s, phase=val, Loss=1.2972, Acc=0.6724]
Training complete in 5m 28s
Best val Acc: 0.672365
Epoch 12/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 616.81it/s, phase=train, Loss=0.5152, Acc=0.8675]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1441.37it/s, phase=val, Loss=1.2545, Acc=0.6681]
Training complete in 5m 54s
Best val Acc: 0.672365
Epoch 13/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 616.50it/s, phase=train, Loss=0.5011, Acc=0.8719]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1378.87it/s, phase=val, Loss=1.2560, Acc=0.6709]
Training complete in 6m 20s
Best val Acc: 0.672365
Epoch 14/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 619.44it/s, phase=train, Loss=0.4702, Acc=0.8788]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1345.68it/s, phase=val, Loss=1.1896, Acc=0.6681]
Training complete in 6m 46s
Best val Acc: 0.672365
Epoch 15/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 619.26it/s, phase=train, Loss=0.4389, Acc=0.8854]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1341.96it/s, phase=val, Loss=1.1592, Acc=0.7023]
Training complete in 7m 13s
Best val Acc: 0.702279
Epoch 16/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 620.50it/s, phase=train, Loss=0.4273, Acc=0.8902]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1354.91it/s, phase=val, Loss=1.1237, Acc=0.7009]
Training complete in 7m 39s
Best val Acc: 0.702279
Epoch 17/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 617.45it/s, phase=train, Loss=0.4264, Acc=0.8886]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1587.61it/s, phase=val, Loss=1.0984, Acc=0.7094]
Training complete in 8m 5s
Best val Acc: 0.709402
Epoch 18/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 614.91it/s, phase=train, Loss=0.4166, Acc=0.8906]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1364.52it/s, phase=val, Loss=1.1829, Acc=0.6795]
Training complete in 8m 31s
Best val Acc: 0.709402
Epoch 19/29
100%|██████████████████████████████████| 15820/15820 [00:40<00:00, 394.62it/s, phase=train, Loss=0.3908, Acc=0.9006]
100%|████████████████████████████████████████| 702/702 [00:02<00:00, 264.98it/s, phase=val, Loss=1.0923, Acc=0.7009]
Training complete in 9m 14s
Best val Acc: 0.709402
Epoch 20/29
100%|██████████████████████████████████| 15820/15820 [00:31<00:00, 497.64it/s, phase=train, Loss=0.2715, Acc=0.9336]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1435.26it/s, phase=val, Loss=0.9947, Acc=0.7507]
Training complete in 9m 47s
Best val Acc: 0.750712
Epoch 21/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 616.04it/s, phase=train, Loss=0.2295, Acc=0.9452]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1344.88it/s, phase=val, Loss=0.9573, Acc=0.7550]
Training complete in 10m 13s
Best val Acc: 0.754986
Epoch 22/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 620.73it/s, phase=train, Loss=0.1992, Acc=0.9536]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1384.97it/s, phase=val, Loss=0.9194, Acc=0.7578]
Training complete in 10m 40s
Best val Acc: 0.757835
Epoch 23/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 620.40it/s, phase=train, Loss=0.1792, Acc=0.9595]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1426.51it/s, phase=val, Loss=0.9153, Acc=0.7593]
Training complete in 11m 6s
Best val Acc: 0.759259
Epoch 24/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 617.85it/s, phase=train, Loss=0.1746, Acc=0.9607]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1442.78it/s, phase=val, Loss=0.8789, Acc=0.7635]
Training complete in 11m 32s
Best val Acc: 0.763533
Epoch 25/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 622.47it/s, phase=train, Loss=0.1683, Acc=0.9614]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1406.50it/s, phase=val, Loss=0.8885, Acc=0.7507]
Training complete in 11m 58s
Best val Acc: 0.763533
Epoch 26/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 623.71it/s, phase=train, Loss=0.1664, Acc=0.9630]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1433.22it/s, phase=val, Loss=0.8765, Acc=0.7721]
Training complete in 12m 24s
Best val Acc: 0.772080
Epoch 27/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 623.06it/s, phase=train, Loss=0.1649, Acc=0.9628]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1344.27it/s, phase=val, Loss=0.8739, Acc=0.7607]
Training complete in 12m 50s
Best val Acc: 0.772080
Epoch 28/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 615.28it/s, phase=train, Loss=0.1610, Acc=0.9647]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1358.17it/s, phase=val, Loss=0.8795, Acc=0.7621]
Training complete in 13m 16s
Best val Acc: 0.772080
Epoch 29/29
100%|██████████████████████████████████| 15820/15820 [00:25<00:00, 620.43it/s, phase=train, Loss=0.1539, Acc=0.9688]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1352.30it/s, phase=val, Loss=0.8434, Acc=0.7764]
Training complete in 13m 43s
Best val Acc: 0.776353
Training complete in 13m 43s
Best val Acc: 0.776353

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py  --gpu_ids 0  --name use_rn18_duke_3 --use_rn18 --batchsize 32  --test_dir data/DukeMTMC-reID/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
17661it [00:32, 550.67it/s]
2228it [00:16, 132.68it/s]
Training complete in 0m 48.87s
use_rn18_duke_3
torch.Size([2228, 512])
Rank@1:0.646768 Rank@5:0.802065 Rank@10:0.846499 mAP:0.439517

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0  --name use_rn18_duke_4 --use_rn18 --batchsize 32  --data_dir data/DukeMTMC-reID/pytorch --ours 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])]
15.302696466445923
Trainable parameters: 11800318
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 15820/15820 [00:36<00:00, 433.47it/s, phase=train, Loss=5.1113, Acc=0.1381]
100%|█████████████████████████████████████████| 702/702 [00:15<00:00, 45.61it/s, phase=val, Loss=3.9894, Acc=0.1838]
Training complete in 0m 52s
Best val Acc: 0.183761
Epoch 1/29
100%|██████████████████████████████████| 15820/15820 [00:37<00:00, 416.80it/s, phase=train, Loss=2.8274, Acc=0.3993]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1461.21it/s, phase=val, Loss=2.5901, Acc=0.3974]
Training complete in 1m 31s
Best val Acc: 0.397436
Epoch 2/29
100%|██████████████████████████████████| 15820/15820 [00:31<00:00, 497.38it/s, phase=train, Loss=1.9172, Acc=0.5690]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1539.71it/s, phase=val, Loss=1.9443, Acc=0.5128]
Training complete in 2m 3s
Best val Acc: 0.512821
Epoch 3/29
100%|██████████████████████████████████| 15820/15820 [00:34<00:00, 460.83it/s, phase=train, Loss=1.4834, Acc=0.6495]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1566.80it/s, phase=val, Loss=1.6429, Acc=0.5869]
Training complete in 2m 38s
Best val Acc: 0.586895
Epoch 4/29
100%|██████████████████████████████████| 15820/15820 [00:28<00:00, 547.60it/s, phase=train, Loss=1.2143, Acc=0.7063]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1608.62it/s, phase=val, Loss=1.4234, Acc=0.6296]
Training complete in 3m 8s
Best val Acc: 0.629630
Epoch 5/29
100%|██████████████████████████████████| 15820/15820 [00:29<00:00, 539.20it/s, phase=train, Loss=1.0386, Acc=0.7442]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1378.87it/s, phase=val, Loss=1.3114, Acc=0.6667]
Training complete in 3m 38s
Best val Acc: 0.666667
Epoch 6/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 471.81it/s, phase=train, Loss=0.9290, Acc=0.7708]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1587.88it/s, phase=val, Loss=1.2127, Acc=0.6624]
Training complete in 4m 12s
Best val Acc: 0.666667
Epoch 7/29
100%|██████████████████████████████████| 15820/15820 [00:31<00:00, 505.17it/s, phase=train, Loss=0.8412, Acc=0.7915]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1451.80it/s, phase=val, Loss=1.2099, Acc=0.6638]
Training complete in 4m 44s
Best val Acc: 0.666667
Epoch 8/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 474.65it/s, phase=train, Loss=0.7881, Acc=0.7996]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1376.44it/s, phase=val, Loss=1.1636, Acc=0.6937]
Training complete in 5m 18s
Best val Acc: 0.693732
Epoch 9/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 472.96it/s, phase=train, Loss=0.7479, Acc=0.8124]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1459.14it/s, phase=val, Loss=1.1989, Acc=0.6724]
Training complete in 5m 52s
Best val Acc: 0.693732
Epoch 10/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 467.77it/s, phase=train, Loss=0.7125, Acc=0.8216]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1341.96it/s, phase=val, Loss=1.1100, Acc=0.6966]
Training complete in 6m 27s
Best val Acc: 0.696581
Epoch 11/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 468.66it/s, phase=train, Loss=0.6594, Acc=0.8313]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1490.71it/s, phase=val, Loss=1.1302, Acc=0.6852]
Training complete in 7m 1s
Best val Acc: 0.696581
Epoch 12/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 473.02it/s, phase=train, Loss=0.6459, Acc=0.8358]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1467.44it/s, phase=val, Loss=1.1064, Acc=0.6852]
Training complete in 7m 35s
Best val Acc: 0.696581
Epoch 13/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 475.11it/s, phase=train, Loss=0.6104, Acc=0.8458]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1447.10it/s, phase=val, Loss=1.0057, Acc=0.7194]
Training complete in 8m 9s
Best val Acc: 0.719373
Epoch 14/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 476.95it/s, phase=train, Loss=0.6061, Acc=0.8433]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1481.23it/s, phase=val, Loss=1.1560, Acc=0.6952]
Training complete in 8m 43s
Best val Acc: 0.719373
Epoch 15/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 470.33it/s, phase=train, Loss=0.5733, Acc=0.8542]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1395.32it/s, phase=val, Loss=1.1016, Acc=0.7066]
Training complete in 9m 17s
Best val Acc: 0.719373
Epoch 16/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 476.81it/s, phase=train, Loss=0.5608, Acc=0.8537]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1300.43it/s, phase=val, Loss=0.9993, Acc=0.7179]
Training complete in 9m 51s
Best val Acc: 0.719373
Epoch 17/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 476.29it/s, phase=train, Loss=0.5371, Acc=0.8632]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1466.61it/s, phase=val, Loss=0.9408, Acc=0.7279]
Training complete in 10m 25s
Best val Acc: 0.727920
Epoch 18/29
100%|██████████████████████████████████| 15820/15820 [00:32<00:00, 479.96it/s, phase=train, Loss=0.5240, Acc=0.8666]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1328.70it/s, phase=val, Loss=0.9641, Acc=0.7407]
Training complete in 10m 58s
Best val Acc: 0.740741
Epoch 19/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 475.33it/s, phase=train, Loss=0.5142, Acc=0.8666]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1462.17it/s, phase=val, Loss=0.9052, Acc=0.7436]
Training complete in 11m 33s
Best val Acc: 0.743590
Epoch 20/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 474.08it/s, phase=train, Loss=0.3689, Acc=0.9076]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1403.69it/s, phase=val, Loss=0.7818, Acc=0.7735]
Training complete in 12m 7s
Best val Acc: 0.773504
Epoch 21/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 470.28it/s, phase=train, Loss=0.3047, Acc=0.9252]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1410.67it/s, phase=val, Loss=0.7291, Acc=0.7892]
Training complete in 12m 41s
Best val Acc: 0.789174
Epoch 22/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 474.00it/s, phase=train, Loss=0.2840, Acc=0.9316]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1360.16it/s, phase=val, Loss=0.7424, Acc=0.7920]
Training complete in 13m 16s
Best val Acc: 0.792023
Epoch 23/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 470.01it/s, phase=train, Loss=0.2636, Acc=0.9370]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1538.20it/s, phase=val, Loss=0.7473, Acc=0.7806]
Training complete in 13m 50s
Best val Acc: 0.792023
Epoch 24/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 473.55it/s, phase=train, Loss=0.2467, Acc=0.9413]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1415.01it/s, phase=val, Loss=0.6817, Acc=0.7949]
Training complete in 14m 24s
Best val Acc: 0.794872
Epoch 25/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 475.94it/s, phase=train, Loss=0.2362, Acc=0.9440]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1439.57it/s, phase=val, Loss=0.7103, Acc=0.7892]
Training complete in 14m 58s
Best val Acc: 0.794872
Epoch 26/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 474.73it/s, phase=train, Loss=0.2323, Acc=0.9461]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1334.30it/s, phase=val, Loss=0.6693, Acc=0.8020]
Training complete in 15m 32s
Best val Acc: 0.801994
Epoch 27/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 475.79it/s, phase=train, Loss=0.2320, Acc=0.9465]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1353.01it/s, phase=val, Loss=0.6759, Acc=0.8006]
Training complete in 16m 6s
Best val Acc: 0.801994
Epoch 28/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 478.83it/s, phase=train, Loss=0.2186, Acc=0.9502]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1534.84it/s, phase=val, Loss=0.6749, Acc=0.8020]
Training complete in 16m 39s
Best val Acc: 0.801994
Epoch 29/29
100%|██████████████████████████████████| 15820/15820 [00:33<00:00, 474.49it/s, phase=train, Loss=0.2142, Acc=0.9516]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1376.17it/s, phase=val, Loss=0.6643, Acc=0.8006]
Training complete in 17m 13s
Best val Acc: 0.801994
Training complete in 17m 13s
Best val Acc: 0.801994

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py  --gpu_ids 0  --name use_rn18_duke_4 --use_rn18 --batchsize 32  --test_dir data/DukeMTMC-reID/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
17661it [00:33, 531.87it/s]
2228it [00:17, 128.99it/s]
Training complete in 0m 50.48s
use_rn18_duke_4
torch.Size([2228, 512])
Rank@1:0.678636 Rank@5:0.815978 Rank@10:0.859066 mAP:0.458490

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>###########################################################
'###########################################################' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>## EfficientNet
'##' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID># Baseline
'#' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0 --name eff_duke_1 --use_efficient --batchsize 32  --data_dir data/DukeMTMC-reID/pytorch --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), RandomHorizontalFlip(p=0.5)]
15.628367185592651
Loaded pretrained weights for efficientnet-b4
Trainable parameters: 20620782
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 15820/15820 [01:04<00:00, 244.68it/s, phase=train, Loss=3.4748, Acc=0.3713]
100%|█████████████████████████████████████████| 702/702 [00:15<00:00, 44.76it/s, phase=val, Loss=1.7816, Acc=0.5527]
Training complete in 1m 21s
Best val Acc: 0.552707
Epoch 1/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 259.73it/s, phase=train, Loss=0.6942, Acc=0.8369]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 839.99it/s, phase=val, Loss=1.2650, Acc=0.6937]
Training complete in 2m 23s
Best val Acc: 0.693732
Epoch 2/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 261.31it/s, phase=train, Loss=0.2803, Acc=0.9322]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 961.43it/s, phase=val, Loss=0.9524, Acc=0.7593]
Training complete in 3m 24s
Best val Acc: 0.759259
Epoch 3/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 260.69it/s, phase=train, Loss=0.1494, Acc=0.9664]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 918.64it/s, phase=val, Loss=0.9632, Acc=0.7379]
Training complete in 4m 26s
Best val Acc: 0.759259
Epoch 4/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 265.80it/s, phase=train, Loss=0.0960, Acc=0.9793]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 863.78it/s, phase=val, Loss=0.9244, Acc=0.7635]
Training complete in 5m 27s
Best val Acc: 0.763533
Epoch 5/29
100%|██████████████████████████████████| 15820/15820 [00:54<00:00, 290.25it/s, phase=train, Loss=0.0709, Acc=0.9887]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1370.47it/s, phase=val, Loss=0.8088, Acc=0.7892]
Training complete in 6m 22s
Best val Acc: 0.789174
Epoch 6/29
100%|██████████████████████████████████| 15820/15820 [00:53<00:00, 298.26it/s, phase=train, Loss=0.0582, Acc=0.9925]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 906.66it/s, phase=val, Loss=0.7882, Acc=0.7991]
Training complete in 7m 16s
Best val Acc: 0.799145
Epoch 7/29
100%|██████████████████████████████████| 15820/15820 [00:46<00:00, 339.05it/s, phase=train, Loss=0.0514, Acc=0.9951]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1195.65it/s, phase=val, Loss=0.7479, Acc=0.8148]
Training complete in 8m 4s
Best val Acc: 0.814815
Epoch 8/29
100%|██████████████████████████████████| 15820/15820 [00:49<00:00, 321.43it/s, phase=train, Loss=0.0461, Acc=0.9966]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 871.86it/s, phase=val, Loss=0.7578, Acc=0.8177]
Training complete in 8m 54s
Best val Acc: 0.817664
Epoch 9/29
100%|██████████████████████████████████| 15820/15820 [00:55<00:00, 283.63it/s, phase=train, Loss=0.0435, Acc=0.9969]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 766.27it/s, phase=val, Loss=0.7744, Acc=0.8105]
Training complete in 9m 51s
Best val Acc: 0.817664
Epoch 10/29
100%|██████████████████████████████████| 15820/15820 [01:01<00:00, 257.93it/s, phase=train, Loss=0.0445, Acc=0.9966]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 872.11it/s, phase=val, Loss=0.7500, Acc=0.8091]
Training complete in 10m 54s
Best val Acc: 0.817664
Epoch 11/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 262.05it/s, phase=train, Loss=0.0420, Acc=0.9975]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 897.08it/s, phase=val, Loss=0.7223, Acc=0.8262]
Training complete in 11m 55s
Best val Acc: 0.826211
Epoch 12/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 265.72it/s, phase=train, Loss=0.0442, Acc=0.9970]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 820.97it/s, phase=val, Loss=0.7265, Acc=0.8077]
Training complete in 12m 55s
Best val Acc: 0.826211
Epoch 13/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 263.57it/s, phase=train, Loss=0.0472, Acc=0.9967]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 927.78it/s, phase=val, Loss=0.7392, Acc=0.8048]
Training complete in 13m 56s
Best val Acc: 0.826211
Epoch 14/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 264.55it/s, phase=train, Loss=0.0391, Acc=0.9977]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 878.14it/s, phase=val, Loss=0.7152, Acc=0.8177]
Training complete in 14m 57s
Best val Acc: 0.826211
Epoch 15/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 254.96it/s, phase=train, Loss=0.0399, Acc=0.9977]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 710.56it/s, phase=val, Loss=0.7058, Acc=0.8219]
Training complete in 16m 0s
Best val Acc: 0.826211
Epoch 16/29
100%|██████████████████████████████████| 15820/15820 [01:01<00:00, 257.36it/s, phase=train, Loss=0.0409, Acc=0.9977]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 829.95it/s, phase=val, Loss=0.7089, Acc=0.8162]
Training complete in 17m 2s
Best val Acc: 0.826211
Epoch 17/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 263.42it/s, phase=train, Loss=0.0370, Acc=0.9981]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 882.29it/s, phase=val, Loss=0.6766, Acc=0.8162]
Training complete in 18m 3s
Best val Acc: 0.826211
Epoch 18/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 262.60it/s, phase=train, Loss=0.0343, Acc=0.9985]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 859.63it/s, phase=val, Loss=0.7138, Acc=0.8205]
Training complete in 19m 5s
Best val Acc: 0.826211
Epoch 19/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 262.39it/s, phase=train, Loss=0.0381, Acc=0.9980]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 806.23it/s, phase=val, Loss=0.6923, Acc=0.8305]
Training complete in 20m 7s
Best val Acc: 0.830484
Epoch 20/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 263.08it/s, phase=train, Loss=0.0268, Acc=0.9991]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 835.14it/s, phase=val, Loss=0.6409, Acc=0.8333]
Training complete in 21m 8s
Best val Acc: 0.833333
Epoch 21/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 260.23it/s, phase=train, Loss=0.0233, Acc=0.9989]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 878.32it/s, phase=val, Loss=0.6124, Acc=0.8405]
Training complete in 22m 10s
Best val Acc: 0.840456
Epoch 22/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 261.10it/s, phase=train, Loss=0.0213, Acc=0.9991]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 826.09it/s, phase=val, Loss=0.6223, Acc=0.8376]
Training complete in 23m 12s
Best val Acc: 0.840456
Epoch 23/29
100%|██████████████████████████████████| 15820/15820 [01:01<00:00, 257.40it/s, phase=train, Loss=0.0217, Acc=0.9991]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 807.74it/s, phase=val, Loss=0.6238, Acc=0.8419]
Training complete in 24m 14s
Best val Acc: 0.841880
Epoch 24/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 259.86it/s, phase=train, Loss=0.0218, Acc=0.9991]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 921.06it/s, phase=val, Loss=0.6039, Acc=0.8419]
Training complete in 25m 16s
Best val Acc: 0.841880
Epoch 25/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 267.80it/s, phase=train, Loss=0.0220, Acc=0.9991]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 882.82it/s, phase=val, Loss=0.6120, Acc=0.8447]
Training complete in 26m 16s
Best val Acc: 0.844729
Epoch 26/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 254.84it/s, phase=train, Loss=0.0217, Acc=0.9992]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 897.50it/s, phase=val, Loss=0.6228, Acc=0.8405]
Training complete in 27m 19s
Best val Acc: 0.844729
Epoch 27/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 265.39it/s, phase=train, Loss=0.0216, Acc=0.9992]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 903.27it/s, phase=val, Loss=0.6001, Acc=0.8419]
Training complete in 28m 20s
Best val Acc: 0.844729
Epoch 28/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 265.62it/s, phase=train, Loss=0.0222, Acc=0.9992]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 861.08it/s, phase=val, Loss=0.6052, Acc=0.8447]
Training complete in 29m 20s
Best val Acc: 0.844729
Epoch 29/29
100%|██████████████████████████████████| 15820/15820 [01:01<00:00, 258.50it/s, phase=train, Loss=0.0227, Acc=0.9992]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 723.55it/s, phase=val, Loss=0.5951, Acc=0.8476]
Training complete in 30m 23s
Best val Acc: 0.847578
Training complete in 30m 23s
Best val Acc: 0.847578

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py --gpu_ids 0 --name eff_duke_1 --use_efficient  --batchsize 32 --test_dir data/DukeMTMC-reID/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Loaded pretrained weights for efficientnet-b4
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
17661it [00:59, 297.67it/s]
2228it [00:21, 104.40it/s]
Training complete in 1m 20.68s
eff_duke_1
torch.Size([2228, 512])
Rank@1:0.745960 Rank@5:0.852783 Rank@10:0.897217 mAP:0.549123

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID># Random Grayscale
'#' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0 --name eff_duke_2 --use_efficient --batchsize 32 --data_dir data/DukeMTMC-reID/pytorch --rge 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <augmentations.RandomGrayscaleErasing object at 0x00000125E34025F0>, RandomHorizontalFlip(p=0.5)]
13.108367919921875
Loaded pretrained weights for efficientnet-b4
Trainable parameters: 20620782
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 15820/15820 [00:57<00:00, 275.63it/s, phase=train, Loss=3.8001, Acc=0.3269]
100%|█████████████████████████████████████████| 702/702 [00:13<00:00, 51.89it/s, phase=val, Loss=1.9446, Acc=0.5456]
Training complete in 1m 11s
Best val Acc: 0.545584
Epoch 1/29
100%|██████████████████████████████████| 15820/15820 [00:44<00:00, 351.95it/s, phase=train, Loss=0.8988, Acc=0.7881]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1283.54it/s, phase=val, Loss=1.1920, Acc=0.6923]
Training complete in 1m 57s
Best val Acc: 0.692308
Epoch 2/29
100%|██████████████████████████████████| 15820/15820 [01:09<00:00, 228.66it/s, phase=train, Loss=0.3816, Acc=0.9075]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1322.98it/s, phase=val, Loss=1.0177, Acc=0.7208]
Training complete in 3m 7s
Best val Acc: 0.720798
Epoch 3/29
100%|██████████████████████████████████| 15820/15820 [00:55<00:00, 284.23it/s, phase=train, Loss=0.2165, Acc=0.9475]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 922.36it/s, phase=val, Loss=0.9673, Acc=0.7635]
Training complete in 4m 4s
Best val Acc: 0.763533
Epoch 4/29
100%|██████████████████████████████████| 15820/15820 [01:01<00:00, 259.24it/s, phase=train, Loss=0.1401, Acc=0.9690]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 875.12it/s, phase=val, Loss=0.8144, Acc=0.7806]
Training complete in 5m 6s
Best val Acc: 0.780627
Epoch 5/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 265.81it/s, phase=train, Loss=0.1003, Acc=0.9815]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 913.63it/s, phase=val, Loss=0.8059, Acc=0.7934]
Training complete in 6m 7s
Best val Acc: 0.793447
Epoch 6/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 261.07it/s, phase=train, Loss=0.0836, Acc=0.9851]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 883.45it/s, phase=val, Loss=0.7741, Acc=0.7920]
Training complete in 7m 8s
Best val Acc: 0.793447
Epoch 7/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 266.37it/s, phase=train, Loss=0.0722, Acc=0.9896]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 748.00it/s, phase=val, Loss=0.7374, Acc=0.8020]
Training complete in 8m 9s
Best val Acc: 0.801994
Epoch 8/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 264.37it/s, phase=train, Loss=0.0583, Acc=0.9930]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 910.18it/s, phase=val, Loss=0.7228, Acc=0.8162]
Training complete in 9m 10s
Best val Acc: 0.816239
Epoch 9/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 263.79it/s, phase=train, Loss=0.0514, Acc=0.9952]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 802.53it/s, phase=val, Loss=0.7272, Acc=0.8162]
Training complete in 10m 11s
Best val Acc: 0.816239
Epoch 10/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 263.22it/s, phase=train, Loss=0.0579, Acc=0.9936]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 898.19it/s, phase=val, Loss=0.6949, Acc=0.8191]
Training complete in 11m 13s
Best val Acc: 0.819088
Epoch 11/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 264.61it/s, phase=train, Loss=0.0552, Acc=0.9953]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 885.57it/s, phase=val, Loss=0.6880, Acc=0.8205]
Training complete in 12m 14s
Best val Acc: 0.820513
Epoch 12/29
100%|██████████████████████████████████| 15820/15820 [01:01<00:00, 259.03it/s, phase=train, Loss=0.0539, Acc=0.9954]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 917.36it/s, phase=val, Loss=0.7127, Acc=0.8091]
Training complete in 13m 16s
Best val Acc: 0.820513
Epoch 13/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 264.51it/s, phase=train, Loss=0.0512, Acc=0.9956]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 947.77it/s, phase=val, Loss=0.7094, Acc=0.8134]
Training complete in 14m 16s
Best val Acc: 0.820513
Epoch 14/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 267.36it/s, phase=train, Loss=0.0452, Acc=0.9968]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 836.06it/s, phase=val, Loss=0.6811, Acc=0.8319]
Training complete in 15m 16s
Best val Acc: 0.831909
Epoch 15/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 265.68it/s, phase=train, Loss=0.0481, Acc=0.9969]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 892.29it/s, phase=val, Loss=0.6823, Acc=0.8348]
Training complete in 16m 17s
Best val Acc: 0.834758
Epoch 16/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 261.54it/s, phase=train, Loss=0.0518, Acc=0.9958]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 923.27it/s, phase=val, Loss=0.6954, Acc=0.8276]
Training complete in 17m 18s
Best val Acc: 0.834758
Epoch 17/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 263.99it/s, phase=train, Loss=0.0466, Acc=0.9963]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 883.33it/s, phase=val, Loss=0.6659, Acc=0.8348]
Training complete in 18m 19s
Best val Acc: 0.834758
Epoch 18/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 263.03it/s, phase=train, Loss=0.0437, Acc=0.9971]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 878.40it/s, phase=val, Loss=0.6785, Acc=0.8219]
Training complete in 19m 20s
Best val Acc: 0.834758
Epoch 19/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 264.20it/s, phase=train, Loss=0.0400, Acc=0.9976]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 808.58it/s, phase=val, Loss=0.6754, Acc=0.8219]
Training complete in 20m 22s
Best val Acc: 0.834758
Epoch 20/29
100%|██████████████████████████████████| 15820/15820 [01:01<00:00, 259.34it/s, phase=train, Loss=0.0331, Acc=0.9978]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 945.88it/s, phase=val, Loss=0.6141, Acc=0.8362]
Training complete in 21m 24s
Best val Acc: 0.836182
Epoch 21/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 262.94it/s, phase=train, Loss=0.0283, Acc=0.9984]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 854.49it/s, phase=val, Loss=0.6130, Acc=0.8305]
Training complete in 22m 25s
Best val Acc: 0.836182
Epoch 22/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 266.77it/s, phase=train, Loss=0.0263, Acc=0.9989]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 886.17it/s, phase=val, Loss=0.5984, Acc=0.8376]
Training complete in 23m 26s
Best val Acc: 0.837607
Epoch 23/29
100%|██████████████████████████████████| 15820/15820 [01:00<00:00, 260.89it/s, phase=train, Loss=0.0249, Acc=0.9989]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 958.37it/s, phase=val, Loss=0.5957, Acc=0.8419]
Training complete in 24m 27s
Best val Acc: 0.841880
Epoch 24/29
100%|██████████████████████████████████| 15820/15820 [00:59<00:00, 263.70it/s, phase=train, Loss=0.0247, Acc=0.9991]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 966.01it/s, phase=val, Loss=0.5853, Acc=0.8447]
Training complete in 25m 28s
Best val Acc: 0.844729
Epoch 25/29
100%|██████████████████████████████████| 15820/15820 [00:57<00:00, 274.44it/s, phase=train, Loss=0.0249, Acc=0.9989]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1312.46it/s, phase=val, Loss=0.5711, Acc=0.8504]
Training complete in 26m 27s
Best val Acc: 0.850427
Epoch 26/29
100%|██████████████████████████████████| 15820/15820 [00:51<00:00, 309.38it/s, phase=train, Loss=0.0244, Acc=0.9991]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 893.39it/s, phase=val, Loss=0.5701, Acc=0.8447]
Training complete in 27m 19s
Best val Acc: 0.850427
Epoch 27/29
100%|██████████████████████████████████| 15820/15820 [00:49<00:00, 317.71it/s, phase=train, Loss=0.0248, Acc=0.9989]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1366.42it/s, phase=val, Loss=0.5781, Acc=0.8462]
Training complete in 28m 9s
Best val Acc: 0.850427
Epoch 28/29
100%|██████████████████████████████████| 15820/15820 [00:46<00:00, 338.72it/s, phase=train, Loss=0.0250, Acc=0.9989]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 854.73it/s, phase=val, Loss=0.5845, Acc=0.8504]
Training complete in 28m 57s
Best val Acc: 0.850427
Epoch 29/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.63it/s, phase=train, Loss=0.0245, Acc=0.9991]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1197.69it/s, phase=val, Loss=0.5697, Acc=0.8519]
Training complete in 30m 1s
Best val Acc: 0.851852
Training complete in 30m 1s
Best val Acc: 0.851852

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py --gpu_ids 0 --name eff_duke_2 --use_efficient  --batchsize 32 --test_dir data/DukeMTMC-reID/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Loaded pretrained weights for efficientnet-b4
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
17661it [00:58, 303.56it/s]
2228it [00:20, 108.96it/s]
Training complete in 1m 18.63s
eff_duke_2
torch.Size([2228, 512])
Rank@1:0.761670 Rank@5:0.872531 Rank@10:0.902603 mAP:0.556813

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID># Random Erasing
'#' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0 --name eff_duke_3 --use_efficient --batchsize 32  --data_dir data/DukeMTMC-reID/pytorch --erasing_p 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]), <augmentations.RandomErasing object at 0x000001817FC025F0>, RandomHorizontalFlip(p=0.5)]
14.365510702133179
Loaded pretrained weights for efficientnet-b4
Trainable parameters: 20620782
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 15820/15820 [01:06<00:00, 239.07it/s, phase=train, Loss=3.9815, Acc=0.2972]
100%|█████████████████████████████████████████| 702/702 [00:14<00:00, 47.89it/s, phase=val, Loss=2.0180, Acc=0.5256]
Training complete in 1m 21s
Best val Acc: 0.525641
Epoch 1/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 248.74it/s, phase=train, Loss=1.1132, Acc=0.7374]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 832.47it/s, phase=val, Loss=1.2223, Acc=0.6638]
Training complete in 2m 26s
Best val Acc: 0.663818
Epoch 2/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 251.72it/s, phase=train, Loss=0.5705, Acc=0.8600]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 881.29it/s, phase=val, Loss=1.0507, Acc=0.7279]
Training complete in 3m 30s
Best val Acc: 0.727920
Epoch 3/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.43it/s, phase=train, Loss=0.3769, Acc=0.9054]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 858.00it/s, phase=val, Loss=0.9782, Acc=0.7450]
Training complete in 4m 34s
Best val Acc: 0.745014
Epoch 4/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 248.30it/s, phase=train, Loss=0.3016, Acc=0.9262]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 879.43it/s, phase=val, Loss=0.8643, Acc=0.7707]
Training complete in 5m 39s
Best val Acc: 0.770655
Epoch 5/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.04it/s, phase=train, Loss=0.2285, Acc=0.9440]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 818.64it/s, phase=val, Loss=0.8838, Acc=0.7707]
Training complete in 6m 43s
Best val Acc: 0.770655
Epoch 6/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.40it/s, phase=train, Loss=0.2025, Acc=0.9521]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 850.72it/s, phase=val, Loss=0.8764, Acc=0.7792]
Training complete in 7m 48s
Best val Acc: 0.779202
Epoch 7/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 251.68it/s, phase=train, Loss=0.1853, Acc=0.9572]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 875.12it/s, phase=val, Loss=0.8541, Acc=0.7806]
Training complete in 8m 52s
Best val Acc: 0.780627
Epoch 8/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.99it/s, phase=train, Loss=0.1842, Acc=0.9582]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 902.66it/s, phase=val, Loss=0.8143, Acc=0.7934]
Training complete in 9m 56s
Best val Acc: 0.793447
Epoch 9/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.09it/s, phase=train, Loss=0.1679, Acc=0.9622]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 796.14it/s, phase=val, Loss=0.7804, Acc=0.7863]
Training complete in 11m 1s
Best val Acc: 0.793447
Epoch 10/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 248.91it/s, phase=train, Loss=0.1505, Acc=0.9666]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 814.56it/s, phase=val, Loss=0.7537, Acc=0.8148]
Training complete in 12m 6s
Best val Acc: 0.814815
Epoch 11/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 252.61it/s, phase=train, Loss=0.1292, Acc=0.9745]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 847.64it/s, phase=val, Loss=0.7498, Acc=0.8048]
Training complete in 13m 9s
Best val Acc: 0.814815
Epoch 12/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.68it/s, phase=train, Loss=0.1254, Acc=0.9745]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 881.21it/s, phase=val, Loss=0.6762, Acc=0.8162]
Training complete in 14m 14s
Best val Acc: 0.816239
Epoch 13/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.66it/s, phase=train, Loss=0.1301, Acc=0.9726]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 913.81it/s, phase=val, Loss=0.6602, Acc=0.8120]
Training complete in 15m 18s
Best val Acc: 0.816239
Epoch 14/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.31it/s, phase=train, Loss=0.1213, Acc=0.9755]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 998.66it/s, phase=val, Loss=0.6879, Acc=0.8262]
Training complete in 16m 22s
Best val Acc: 0.826211
Epoch 15/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.95it/s, phase=train, Loss=0.1246, Acc=0.9759]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 877.12it/s, phase=val, Loss=0.6808, Acc=0.8276]
Training complete in 17m 26s
Best val Acc: 0.827635
Epoch 16/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.52it/s, phase=train, Loss=0.1183, Acc=0.9759]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 866.47it/s, phase=val, Loss=0.7226, Acc=0.8105]
Training complete in 18m 30s
Best val Acc: 0.827635
Epoch 17/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.55it/s, phase=train, Loss=0.1132, Acc=0.9784]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 865.41it/s, phase=val, Loss=0.6330, Acc=0.8362]
Training complete in 19m 35s
Best val Acc: 0.836182
Epoch 18/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.47it/s, phase=train, Loss=0.1000, Acc=0.9821]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 900.86it/s, phase=val, Loss=0.6781, Acc=0.8248]
Training complete in 20m 39s
Best val Acc: 0.836182
Epoch 19/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 251.18it/s, phase=train, Loss=0.1017, Acc=0.9813]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 892.22it/s, phase=val, Loss=0.6725, Acc=0.8276]
Training complete in 21m 44s
Best val Acc: 0.836182
Epoch 20/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.09it/s, phase=train, Loss=0.0770, Acc=0.9860]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 863.28it/s, phase=val, Loss=0.5928, Acc=0.8490]
Training complete in 22m 48s
Best val Acc: 0.849003
Epoch 21/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.62it/s, phase=train, Loss=0.0577, Acc=0.9911]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 863.28it/s, phase=val, Loss=0.5750, Acc=0.8490]
Training complete in 23m 53s
Best val Acc: 0.849003
Epoch 22/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.76it/s, phase=train, Loss=0.0510, Acc=0.9932]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 896.76it/s, phase=val, Loss=0.5462, Acc=0.8575]
Training complete in 24m 57s
Best val Acc: 0.857550
Epoch 23/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.22it/s, phase=train, Loss=0.0495, Acc=0.9921]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 859.68it/s, phase=val, Loss=0.5470, Acc=0.8547]
Training complete in 26m 1s
Best val Acc: 0.857550
Epoch 24/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.73it/s, phase=train, Loss=0.0464, Acc=0.9930]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 858.00it/s, phase=val, Loss=0.5462, Acc=0.8533]
Training complete in 27m 5s
Best val Acc: 0.857550
Epoch 25/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.38it/s, phase=train, Loss=0.0494, Acc=0.9927]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 862.22it/s, phase=val, Loss=0.5191, Acc=0.8575]
Training complete in 28m 10s
Best val Acc: 0.857550
Epoch 26/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.95it/s, phase=train, Loss=0.0454, Acc=0.9937]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 870.48it/s, phase=val, Loss=0.5425, Acc=0.8533]
Training complete in 29m 14s
Best val Acc: 0.857550
Epoch 27/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 252.00it/s, phase=train, Loss=0.0451, Acc=0.9940]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 816.80it/s, phase=val, Loss=0.5246, Acc=0.8561]
Training complete in 30m 18s
Best val Acc: 0.857550
Epoch 28/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 247.78it/s, phase=train, Loss=0.0433, Acc=0.9943]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 835.98it/s, phase=val, Loss=0.5083, Acc=0.8632]
Training complete in 31m 23s
Best val Acc: 0.863248
Epoch 29/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 248.99it/s, phase=train, Loss=0.0438, Acc=0.9944]
100%|████████████████████████████████████████| 702/702 [00:00<00:00, 802.11it/s, phase=val, Loss=0.5378, Acc=0.8575]
Training complete in 32m 28s
Best val Acc: 0.863248
Training complete in 32m 28s
Best val Acc: 0.863248

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py --gpu_ids 0 --name eff_duke_3 --use_efficient  --batchsize 32 --test_dir data/DukeMTMC-reID/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Loaded pretrained weights for efficientnet-b4
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
17661it [00:58, 303.37it/s]
2228it [00:17, 126.12it/s]
Training complete in 1m 15.89s
eff_duke_3
torch.Size([2228, 512])
Rank@1:0.801616 Rank@5:0.898564 Rank@10:0.922352 mAP:0.622559

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>
(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID># Foreground Background Augmentation
'#' is not recognized as an internal or external command,
operable program or batch file.

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python train.py --gpu_ids 0 --name eff_duke_4 --use_efficient --batchsize 32  --data_dir data/DukeMTMC-reID/pytorch --ours 0.5 --total_epoch 30
[Resize(size=(256, 128), interpolation=bicubic, max_size=None, antialias=True), ToTensor(), Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])]
16.19360113143921
Loaded pretrained weights for efficientnet-b4
Trainable parameters: 20620782
Compiling model... The first epoch may be slow, which is expected!
Epoch 0/29
100%|██████████████████████████████████| 15820/15820 [01:13<00:00, 214.81it/s, phase=train, Loss=4.0983, Acc=0.2790]
100%|█████████████████████████████████████████| 702/702 [00:12<00:00, 54.25it/s, phase=val, Loss=2.0873, Acc=0.4915]
Training complete in 1m 27s
Best val Acc: 0.491453
Epoch 1/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.75it/s, phase=train, Loss=1.2639, Acc=0.7055]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1238.98it/s, phase=val, Loss=1.1280, Acc=0.7151]
Training complete in 2m 31s
Best val Acc: 0.715100
Epoch 2/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 248.60it/s, phase=train, Loss=0.7034, Acc=0.8303]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1253.66it/s, phase=val, Loss=0.9837, Acc=0.7407]
Training complete in 3m 35s
Best val Acc: 0.740741
Epoch 3/29
100%|██████████████████████████████████| 15820/15820 [01:04<00:00, 246.73it/s, phase=train, Loss=0.5035, Acc=0.8747]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1257.51it/s, phase=val, Loss=0.8743, Acc=0.7707]
Training complete in 4m 41s
Best val Acc: 0.770655
Epoch 4/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.47it/s, phase=train, Loss=0.3975, Acc=0.8997]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1296.46it/s, phase=val, Loss=0.7199, Acc=0.7849]
Training complete in 5m 45s
Best val Acc: 0.784900
Epoch 5/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.03it/s, phase=train, Loss=0.3107, Acc=0.9203]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1224.86it/s, phase=val, Loss=0.6848, Acc=0.8020]
Training complete in 6m 49s
Best val Acc: 0.801994
Epoch 6/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.60it/s, phase=train, Loss=0.2784, Acc=0.9319]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1279.75it/s, phase=val, Loss=0.6722, Acc=0.8105]
Training complete in 7m 53s
Best val Acc: 0.810541
Epoch 7/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.22it/s, phase=train, Loss=0.2659, Acc=0.9332]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1229.18it/s, phase=val, Loss=0.6457, Acc=0.8048]
Training complete in 8m 57s
Best val Acc: 0.810541
Epoch 8/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.36it/s, phase=train, Loss=0.2378, Acc=0.9417]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1242.20it/s, phase=val, Loss=0.6353, Acc=0.8048]
Training complete in 10m 1s
Best val Acc: 0.810541
Epoch 9/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.52it/s, phase=train, Loss=0.2217, Acc=0.9453]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1251.06it/s, phase=val, Loss=0.6171, Acc=0.8319]
Training complete in 11m 6s
Best val Acc: 0.831909
Epoch 10/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 251.16it/s, phase=train, Loss=0.2008, Acc=0.9530]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1290.15it/s, phase=val, Loss=0.6143, Acc=0.8291]
Training complete in 12m 9s
Best val Acc: 0.831909
Epoch 11/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.71it/s, phase=train, Loss=0.1891, Acc=0.9554]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1246.61it/s, phase=val, Loss=0.6381, Acc=0.8305]
Training complete in 13m 13s
Best val Acc: 0.831909
Epoch 12/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.57it/s, phase=train, Loss=0.1890, Acc=0.9561]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1256.51it/s, phase=val, Loss=0.5777, Acc=0.8319]
Training complete in 14m 17s
Best val Acc: 0.831909
Epoch 13/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 252.68it/s, phase=train, Loss=0.1841, Acc=0.9585]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1268.44it/s, phase=val, Loss=0.5882, Acc=0.8234]
Training complete in 15m 20s
Best val Acc: 0.831909
Epoch 14/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.10it/s, phase=train, Loss=0.1631, Acc=0.9624]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1244.40it/s, phase=val, Loss=0.5890, Acc=0.8319]
Training complete in 16m 24s
Best val Acc: 0.831909
Epoch 15/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.23it/s, phase=train, Loss=0.1621, Acc=0.9633]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1248.78it/s, phase=val, Loss=0.6268, Acc=0.8177]
Training complete in 17m 28s
Best val Acc: 0.831909
Epoch 16/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 251.19it/s, phase=train, Loss=0.1624, Acc=0.9653]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1254.67it/s, phase=val, Loss=0.5978, Acc=0.8348]
Training complete in 18m 32s
Best val Acc: 0.834758
Epoch 17/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 247.28it/s, phase=train, Loss=0.1549, Acc=0.9669]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1253.09it/s, phase=val, Loss=0.5421, Acc=0.8348]
Training complete in 19m 37s
Best val Acc: 0.834758
Epoch 18/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 251.43it/s, phase=train, Loss=0.1551, Acc=0.9662]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1264.58it/s, phase=val, Loss=0.5650, Acc=0.8390]
Training complete in 20m 40s
Best val Acc: 0.839031
Epoch 19/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.93it/s, phase=train, Loss=0.1342, Acc=0.9713]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1213.68it/s, phase=val, Loss=0.6012, Acc=0.8362]
Training complete in 21m 45s
Best val Acc: 0.839031
Epoch 20/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.24it/s, phase=train, Loss=0.1055, Acc=0.9799]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1278.40it/s, phase=val, Loss=0.4953, Acc=0.8590]
Training complete in 22m 49s
Best val Acc: 0.858974
Epoch 21/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 251.51it/s, phase=train, Loss=0.0837, Acc=0.9835]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1235.96it/s, phase=val, Loss=0.4679, Acc=0.8632]
Training complete in 23m 53s
Best val Acc: 0.863248
Epoch 22/29
100%|██████████████████████████████████| 15820/15820 [01:02<00:00, 251.93it/s, phase=train, Loss=0.0742, Acc=0.9868]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1237.82it/s, phase=val, Loss=0.4553, Acc=0.8661]
Training complete in 24m 57s
Best val Acc: 0.866097
Epoch 23/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 248.44it/s, phase=train, Loss=0.0710, Acc=0.9882]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1277.55it/s, phase=val, Loss=0.4148, Acc=0.8746]
Training complete in 26m 1s
Best val Acc: 0.874644
Epoch 24/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.99it/s, phase=train, Loss=0.0670, Acc=0.9888]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1261.09it/s, phase=val, Loss=0.4232, Acc=0.8689]
Training complete in 27m 5s
Best val Acc: 0.874644
Epoch 25/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.07it/s, phase=train, Loss=0.0692, Acc=0.9878]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1269.16it/s, phase=val, Loss=0.4512, Acc=0.8661]
Training complete in 28m 9s
Best val Acc: 0.874644
Epoch 26/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 247.49it/s, phase=train, Loss=0.0647, Acc=0.9886]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1272.24it/s, phase=val, Loss=0.4297, Acc=0.8704]
Training complete in 29m 14s
Best val Acc: 0.874644
Epoch 27/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 249.71it/s, phase=train, Loss=0.0595, Acc=0.9896]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1294.50it/s, phase=val, Loss=0.4261, Acc=0.8704]
Training complete in 30m 18s
Best val Acc: 0.874644
Epoch 28/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 247.47it/s, phase=train, Loss=0.0619, Acc=0.9895]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1207.91it/s, phase=val, Loss=0.4321, Acc=0.8718]
Training complete in 31m 23s
Best val Acc: 0.874644
Epoch 29/29
100%|██████████████████████████████████| 15820/15820 [01:03<00:00, 250.67it/s, phase=train, Loss=0.0602, Acc=0.9913]
100%|███████████████████████████████████████| 702/702 [00:00<00:00, 1218.48it/s, phase=val, Loss=0.4233, Acc=0.8732]
Training complete in 32m 27s
Best val Acc: 0.874644
Training complete in 32m 27s
Best val Acc: 0.874644

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>python test.py --gpu_ids 0 --name eff_duke_4 --use_efficient  --batchsize 32 --test_dir data/DukeMTMC-reID/pytorch --which_epoch last
We use the scale: 1
-------test-----------
Loaded pretrained weights for efficientnet-b4
Here I fuse conv and bn for faster inference, and it does not work for transformers. Comment out this following line if you do not want to fuse conv&bn.
17661it [00:43, 401.56it/s]
2228it [00:16, 138.06it/s]
Training complete in 1m 0.12s
eff_duke_4
torch.Size([2228, 512])
Rank@1:0.815081 Rank@5:0.902154 Rank@10:0.928187 mAP:0.640662

(sam2_env) C:\Users\pp4405\Downloads\Foreground-Background-Augmentation-main (1)\Foreground-Background-Augmentation-main\Person_ReID>